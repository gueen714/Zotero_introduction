\documentclass[theorem=false,mathfont=none,openany,sub3section]{easybook}

\usepackage[lang=cn,newtx]{eb-elegantbook}
%\usepackage[T1]{fontenc}
%\usepackage{codehigh}
%\lstset{moreemph={nofont,thmenv}}

\title{优雅地用Zotero进行文献管理和论文写作}
\subtitle{A Short Intrduction to Zotero}

\author{韩敏义}
\institute{南京农业大学}
\date{2024年9月}
\version{4.00}
%\bioinfo{自定义}{信息}
%\extrainfo{Victory won\rq t come to us unless we go to it. --- M. Moore}
%\setcounter{tocdepth}{3}
\logo{logo.jpg}
\cover{cover.jpg}
% 本文档命令
%\usepackage{array} %easybase已经带
\newcommand{\ccr}[1]{\makecell{{\color{#1}\rule{1cm}{1cm}}}}
%章节显示调整
%\renewcommand\thesection{\zhnumber{chapter}.\arabic{subsection}}
%\renewcommand\thesection{\zhnumber{chapter}.\arabic{section}}
%\renewcommand\thesection{\zhnumber{section}}
%\renewcommand{\thesection}{第~\zhnumber{\arabic{section}}~节}
%package
\usepackage{hyperref}
\usepackage{cleveref}
%改为第X章
\crefformat{chapter}{#2第{#1}章#3}
%改为第X节
\crefformat{section}{#2第#1节#3}
%改为第X页
\crefformat{page}{#2第#1页#3}
%图表调整
\def\figureautorefname{图}%
\def\tableautorefname{表}%

%修改链接颜色
%\hypersetup{linkcolor=blue,
 %   citecolor=blue,
 %   urlcolor=blue}

%修改题注为符号
\renewcommand*{\thefootnote}{\fnsymbol{footnote}}
\renewcommand*{\theupfootnote}{\fnsymbol{footnote}}
% 修改目录深度
\setcounter{tocdepth}{3}  
%\usepackage[text={140mm,240mm},centering]{geometry}

% \usepackage[backend=biber]{biber}
%\usepackage{listings} %easybase已经带
%XML高亮显示定义
%\usepackage{color} %easybase已经带
\definecolor{gray}{rgb}{0.4,0.4,0.4}
\definecolor{darkblue}{rgb}{0.0,0.0,0.6}
\definecolor{cyan}{rgb}{0.0,0.6,0.6}

\lstset{
basicstyle=\ttfamily,
columns=fullflexible,
showstringspaces=false,
commentstyle=\color{gray}\upshape
}

\lstdefinelanguage{XML}
{
morestring=[b]",
morestring=[s]{>}{<},
morecomment=[s]{<?}{?>},
stringstyle=\color{black},
identifierstyle=\color{darkblue},
keywordstyle=\color{cyan},
morekeywords={xmlns,version,type}% list your attributes here
}

%JavaScript定义
\lstdefinelanguage{JavaScript}{
    keywords={typeof, new, true, false, catch, function, return, null, catch, switch, var, if, in, while, do, else, case, break},
    keywordstyle=\color{blue}\bfseries,
    ndkeywords={class, export, boolean, throw, implements, import, this},
    ndkeywordstyle=\color{darkgray}\bfseries,
    identifierstyle=\color{black},
    sensitive=false,
    comment=[l]{//},
    morecomment=[s]{/*}{*/},
    commentstyle=\color{purple}\ttfamily,
    stringstyle=\color{red}\ttfamily,
    morestring=[b]',
    morestring=[b]"
  }

  \lstset{
     language=JavaScript,
     %backgroundcolor=\color{lightgray},
     extendedchars=true,
     basicstyle=\footnotesize\ttfamily,
     showstringspaces=false,
     showspaces=false,
     %numbers=left,
     %numberstyle=\footnotesize,
     %numbersep=9pt,
     tabsize=2,
     breaklines=true,
     showtabs=false,
     captionpos=b
  }



%\usepackage[T1]{fontenc}
\usepackage[os=win]{menukeys} %使用目录、菜单、按键
\renewmenumacro{\menu}[-]{menus} %将默认的>改为-
\newmenumacro{\winpath}[bslash]{hyphenatepathswithfolder} %修改为winpath
%\newmenumacro{\winpath}[bslash]{hyphenatepathswithfolder}
%\usepackage{indentfirst}

\begin{document}
\maketitle
\frontmatter
\chapter*{内容简介}
\markboth{Introduction}{内容简介}

文献管理软件对于参考文献的管理、阅读，在论文撰写过程中插入参考文献有很大的帮助作用，其种类有很多，有商业软件，
如\href{https://endnote.com/}{Endnote}，
\href{http://www.inoteexpress.com/aegean/}{NoteExpress}等,
也有免费开源的，如\href{https://www.zotero.org/}{Zotero}，
\href{https://www.mendeley.com/download-reference-manager/}{Mendeley}等，在试用过很多软件后，发现免费开源的\href{https://www.zotero.org/}{Zotero}
可以很方便的从网上导入文献，管理文献及与Word集成，在撰写文章的时候方便的插入参考文献。
\href{https://endnote.com/}{Endnote}用的人很多，也很
简单易用，为什么还要学习\href{https://www.zotero.org/}{Zotero}呢？最吸引我的在于三个方面，首先，\href{https://www.zotero.org/}{Zotero}开源免费，不用再找破解版或license了。
其次，如果有权限，\href{https://www.zotero.org/}{Zotero}在下载题录\footnote{根据\href{https://zhidao.baidu.com/question/443193991.html}
  {百度知道}，题录是指文献的基本信息，包括题名、作者、关键词、作者机构、文献来源、摘要等。选择保存题录是指当获得检索结果后，
  如需要将检索结果的目录保存以供他用时，可在检索结果的简单页面上选择条目进行保存。}的同时可以把全文也下载下来，
并且自动链接到相应题录上\footnote{使用新的\href{https://github.com/Zotero-CN/translators_CN}{cnki.js}后也可以在导入题录的同时下载知网的PDF。
  详见\cref{sec:cnki_fulltext}。但因为网络原因或知网升级，有可能不能获取全文PDF。}；最后，\href{https://www.zotero.org/}{Zotero}结合其他的同步盘如\href{https://www.jianguoyun.com}{坚果云}、
\href{https://office.live.com/start/OneDrive.aspx}{OneDrive}使得在不同电脑间同步题录和全文也变得十分方便。
因此推荐大家学习一下\href{https://www.zotero.org/}{Zotero}的使用。
\
如果你只想用\href{https://www.zotero.org/}{Zotero}从网上导入题录，请看\cref{ch:install}，这章介绍了\href{https://www.zotero.org/}{Zotero}的下载安装，从网站导入题录及链接全文。
如果还想用\href{https://www.zotero.org/}{Zotero}在Word中插入参考文献，请看\cref{ch:insert}，如果你还有同步题录及全文的需要，请看\cref{ch:syn}。
如果你加入了学科组，有共享群组文献的需要或从群组库复制文献，请看\cref{ch:group}。一些高级应用请看\cref{ch:questions}。


本文档在\href{http://tug.org/texlive/}{\TeX{} Live 2024} 环境下用\href{https://texstudio.org/}{TeXstudio}
编译，
文档编辑中
使用了\href{https://ctan.org/pkg/easybook}{easybook书籍模板}在此致谢；
本文档遵循\href{https://www.gnu.org/licenses/gpl-3.0.txt}{GPL LICENSE} 。
如果你觉得本文档对你有帮助，可以到项目的主页
\url{https://github.com/redleafnew/Zotero_introduction}加星。
如发现问题请反馈至\href{mailto:redleafnew@163.com}{redleafnew@163.com}，
或关注我的知乎专栏\href{https://zhuanlan.zhihu.com/c_1071081428967743488}{软件随心}，
访问\href{https://github.com/redleafnew/Chinese-std-GB-T-7714-related-csl}
{Chinese-STD-GB-T-7714-related-csl}
找到更多的GB/T 7714相关的csl以及\href{https://www.zotero.org/}{Zotero}使用技巧及教程，如果您想了解作者，请参见我的
\href{http://food.njau.edu.cn/info/1129/1315.htm}{学校主页}或
\href{https://baike.baidu.com/item/%E9%9F%A9%E6%95%8F%E4%B9%89}{百度百科主页}谢谢。

\tableofcontents

\listofchanges
2024.9.20：更新为4.0。针对Zotero 7.0增删部分内容。使用\href{https://ctan.org/pkg/easybook}{easybook书籍模板}。

2022.3.20：更新为3.0。

2021.10.2：更新为2.0。

2021.1.10：更新为1.12。

\mainmatter

%第一章
\chapter[Zotero下载安装及题录导入]{Zotero下载安装及题录导入\footnote{以下介绍的\href{https://www.zotero.org/}{Zotero}都是基于英文界面操作，
    大家可以方便地根据截图找到相应的中文界面位置。如果想更改\href{https://www.zotero.org/}{Zotero}的界面语言
    参见\cref{sec:chang_gui_lan}。}}\label{ch:install}


\section{Zotero的安装}
\href{https://www.zotero.org/}{Zotero}原来是基于Firefox浏览器的一个插件，现在有基于桌面的独立安装版。\href{https://www.zotero.org/}{Zotero}支持现在常见的操作系统，
如Windows、Linux、macOS及iOS。
可以到\url{https://www.zotero.org/download/}去下载相应操作系统及位数的安装包。
这里以Windowns 64位版本的安装文件为例进行说明。
\begin{enumerate}
  \item 双击下载的安装文件，如Zotero-x.x.x\_setup.exe(x为具体的版本号，\autoref{fig:package})，
        首先会显示正在解压的界面，如\autoref{fig:extracting}所示，
        如果出现用户帐户控制，点击\menu{是}，如\autoref{fig:userControl}：
        \begin{figure}[htbp]
          \centering
          \begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
            \centering
            \includegraphics[width=0.3\linewidth]{ch1package}
            \caption{下载的安装包}
            \label{fig:package}
          \end{minipage}
          \begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
            \centering
            \includegraphics[scale=1.4]{ch1extracting}
            \caption{安装文件解压界面}
            \label{fig:extracting}
          \end{minipage}
        \end{figure}

  \item 然后出现安装向导，如\autoref{fig:installwiz1}所示，\menu{下一步}。
        %fig user control
        \begin{figure}[htbp]
          \centering
          \begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
            \centering
            \includegraphics[scale = 1.3]{ch1userControl}
            \caption{用户帐户控制}
            \label{fig:userControl}
          \end{minipage}
          \hspace{1em}
          \begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
            \centering
            \includegraphics[scale = 0.8]{ch1installwiz1}
            \caption{安装向导第一步}
            \label{fig:installwiz1}
          \end{minipage}
        \end{figure}
  \item 接下来选择安装类型，如\autoref{fig:installType},
        一般选择Standard(标准)就可以，如果有兴趣也可以选择Custom(定制)，
        选择Custom在点下一步会提示可以修改安装目录
        (默认安装目录为\winpath{C:\Program Files (x86)\Zotero} )以及是否在桌面上及
        开始菜单的程序组中放置图标。
  \item 选择Standard后\menu{下一步}提示安装目录为\winpath{C:\Program Files (x86)\Zotero}，
        此处无法修改安装目录，
        如\autoref{fig:ch1StartInstall}。如果要修改需要在上一步选择Custom选项。
  \item 此时信息已经收集完毕，点击\menu{Install}(安装)就开始安装了，如\autoref{fig:ch1Installing}。
  \item 最后安装完成，点击\menu{Finish}(完成)就可以打开Zotero，如\autoref{fig:ch1InstallComplete}所示。
  \item 也可以下载
        \href{https://www.zotero.org/download/client/dl?channel=release&platform=win-x64-zip}{64位ZIP格式}或
        \href{https://www.zotero.org/download/client/dl?channel=release&platform=win32-zip}{32位ZIP格式}，
        解压到自己的文件夹后直接运行文件夹中的zotero.exe使用。或从\href{https://github.com/pedrom34/ZoteroPortable}
        {https://github.com/pedrom34/ZoteroPortable}下载便携格式，
        下载的方法是在页面上点击绿色的\menu{Code}按钮，
        再点击\menu{Download ZIP}，下载完毕后解压，运行ZoteroPortable.exe即可打开Zotero，使用也十分方便，甚至可以解压到U盘，
        做到真正的便携。使用便携版的另一外好处是Zotero的配置文件和数据文件都在这个文件夹中，如果不放在系统盘，
        重装系统时不用再重装Zotero，直接双击ZoteroPortable.exe即可继续使用，便携版的安装及使用详见
        \href{https://zhuanlan.zhihu.com/p/350797263}{Zotero便携版的安装与使用
          \url{https://zhuanlan.zhihu.com/p/350797263}}。
\end{enumerate}

\begin{figure}[htbp]
  \centering
  \begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
    \centering
    \includegraphics[scale=0.43]{ch1InstallType}
    \caption{选择安装类型}
    \label{fig:installType}
  \end{minipage}
  \hspace{1cm}
  \centering
  \begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
    %fig install start
    \centering
    \includegraphics[scale=0.43]{ch1StartInstall}
    \caption{\menu{Install}开始安装}
    \label{fig:ch1StartInstall}
  \end{minipage}
\end{figure}

%fig installing
\begin{figure}[htbp]
  \noindent
  \centering
  \begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
    \centering
    \includegraphics[scale=0.43]{ch1Installing}
    \caption{Zotero正在安装}
    \label{fig:ch1Installing}
  \end{minipage}
  \hspace{1cm}
  \noindent
  \begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
    %fig install complete
    \centering
    \includegraphics[scale=0.43]{ch1InstallComplete}
    \caption{Zotero安装完成}
    \label{fig:ch1InstallComplete}
  \end{minipage}
\end{figure}

\section{浏览器插件的安装}
要想快速的导入文献，最好装上Zotero的浏览器插件。
Zotero针对不同的浏览器(Chrome、Firefox、Safari和最新的Chromium内核的Edge,不支持IE浏览器)
有不同的插件。	在这里推荐比较好用的Chrome内核浏览器：
CentBrowser(百分浏览器)，可以到\url{http://www.centbrowser.cn/history.html}
根据自己的操作系统位数，下载安装版或便携版。

在访问\href{https://www.zotero.org/download/}
{Zotero浏览器插件安装网站https://www.zotero.org/download/}时，
网站会检测当前所用浏览器内核，提示安装相应插件，
如\autoref{fig:ch1PluginWeb}所示。可以直接点击\menu{Install Chrome Connector}，
然后出现是否需要安装的提示，如\autoref{fig:ch1PluginInstall},
点击\menu{添加扩展程序}进行插件安装。插件的安装过程有可能需要翻墙，
成功安装后会在合适的位置根据当前网页的类型显示不同图标，
一般网页的图标如\autoref{fig:ch1ZoteroIcon}显示,如果没有打开网站，
则会显示一个灰色的“Z”。

如果无法安装，可以到\href{https://crxdown.com/}
{https://crxdown.com/}，输入ID“ekhagklcjbdpajgpjgmbionohlpdbjgc”（不含引号），点击\menu{下载}，下载针对Chrome内核的插件进行离线安装。
% browser type
\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.6\linewidth]{ch1PluginWeb}
  \caption{Zotero浏览器插件安装网站会自动检测当前浏览器类型}
  \label{fig:ch1PluginWeb}
\end{figure}
% install connector
\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.6\linewidth]{ch1PluginInstall}
  \caption{浏览器提示是否安装插件(扩展程序)}
  \label{fig:ch1PluginInstall}
\end{figure}
%zotero icon
\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.8\linewidth]{ch1ZoteroIcon}
  \caption{Zotero浏览器中显示的图标}
  \label{fig:ch1ZoteroIcon}
\end{figure}

下载后离线安装的方法是，以百分浏览器为例，
将下载的zotero\_connector\_x.crx(x为版本号)拖入百分浏览器，
而后浏览器的提示与\autoref{fig:ch1PluginInstall}类似，
如\autoref{fig:ch1PluginInstall2}。
%zotero icon
\begin{figure}[htbp]
  \centering
  \includegraphics[width=0.7\linewidth]{ch1PluginInstall2}
  \caption{将下载的插件拖入到百分浏览器后的提示}
  \label{fig:ch1PluginInstall2}
\end{figure}

Google 的 Chrome 浏览器宣布从最新Chrome版本开始默认只允许从 Chrome Web Store
下载安装扩展程序，网上有一些解决办法，但我没有试成功。
所以只能翻墙在Chrome的应用商店上下载或是使用修改版的Chrome，新版的Chromium内核的Edge
浏览器体现也不错，可以不用翻墙访问微软的扩展商店，方便地安装Zotero浏览器插件。

\section{Zotero插件安装}\label{sec:installPlug}
支持插件是Zotero的特色之一，安装插件后会使Zotero功能更加强大，Zotero插件的文件扩展名为xpi。大多数插件的发布网站为\href{https://github.com/}{Github}或\href{https://gitee.com/}{Gitee}开源仓库。本部分以\href{https://github.com/syt2/zotero-addons}{Zotero 插件市场}插件为例进行讲述，使用\href{https://github.com/syt2/zotero-addons}{Zotero 插件市场}可以安装部分常用插件，其它插件可以按下面讲述的方法进行安装。
\begin{enumerate}
	\item 点击\href{https://github.com/syt2/zotero-addons/releases/latest/download/zotero-addons.xpi}{https://github.com/syt2/zotero-addons/releases/latest/download/zotero-addons.xpi}，浏览器将会下载\href{https://github.com/syt2/zotero-addons}{Zotero 插件市场}的安装文件\footnote{一些常用的Zotero插件可以到\href{https://zotero-chinese.com/plugins/}{Zotero 插件商店}下载。}，保存到自己可以找到的位置，如电脑桌面。
	\item 在Zotero中依次点击击\menu{Tools-Plugins}，如\autoref{fig:ch1installPlugin1}所示，在弹出的对话框中点击\menu{齿轮-Install Plugin From File}，如\autoref{fig:ch1installPlugin2}所示，在弹出的对话框中浏览找到刚才下载的插件安装文件,如\autoref{fig:ch1installPlugin3}，点击打开，然后插件就会安装，安装完毕后在管理插件界面就会出现刚才安装的插件，如\autoref{fig:ch1installPlugin4}所示。
	
	%插件安装
	\begin{figure}[htbp]
		\centering
		\begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
			\centering
			\includegraphics[scale=0.8]{ch1installPlugin1}
			\caption{Zotero插件安装步骤1}
			\label{fig:ch1installPlugin1}
			\end{minipage}
			\hspace{1.5cm}
			\begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
			\centering
			\includegraphics[scale=0.5]{ch1installPlugin2}
			\caption{Zotero插件安装步骤2}
			\label{fig:ch1installPlugin2}
			\end{minipage}
	\end{figure}
	
	%插件安装步骤3
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.8]{ch1installPlugin3}
		\caption{Zotero插件安装步骤3}
		\label{fig:ch1installPlugin3}
	\end{figure}
	
	%插件安装步骤4
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.8]{ch1installPlugin4}
		\caption{已经安装的Zotero的插件}
		\label{fig:ch1installPlugin4}
	\end{figure}
	
	\item 利用\href{https://github.com/syt2/zotero-addons}{Zotero 插件市场}安装插件：
	安装完Zotero插件市场后，一些常用的Zotero插件也可以通过\href{https://github.com/syt2/zotero-addons}{Zotero 插件市场}安装，方法如下：
	点击Zotero工具条上\href{https://github.com/syt2/zotero-addons}{Zotero 插件市场}的按钮，将会弹出\href{https://github.com/syt2/zotero-addons}{Zotero 插件市场}的界面，在里面显示了\href{https://github.com/syt2/zotero-addons}{Zotero 插件市场}支持的插件，包括了插件的名称、简单描述、发布时间、服务器最新版本、本地安装版本、本地状态（没有安装、禁用、已安装），最好将Automatic update add-ons选中，这样安装的插件就会自动更新。右击需要安装的插件，如Jasminum（茉莉花），再点击\menu{Install}，Zotero插件市场将会安装刚才选中的插件，如\autoref{fig:ch1installPlugin5}所示，如果安装不正常可以在Select Source中选择其他的安装源。可以根据自己的需求安装插件，其中\href{https://github.com/windingwind/zotero-pdf-translate}{Translate for Zotero}、\href{https://github.com/l0o0/jasminum}{Jasminum}、\href{https://github.com/windingwind/zotero-better-notes}{Better Notes for Zotero}、\href{https://github.com/windingwind/zotero-actions-tags}{Actions and Tags for Zotero}、\href{https://github.com/redleafnew/zotero-updateifsE}{Green Frog}、\href{https://github.com/MuiseDestiny/zotero-attanger}{Zotero Attanger}等是比较常用的插件，这些插件的功能及使用方法请参考网上一些教程。
 
		%插件安装步骤5
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.6]{ch1installPlugin5}
		\caption{用\href{https://github.com/syt2/zotero-addons}{Zotero 插件市场}安装插件}
		\label{fig:ch1installPlugin5}
	\end{figure}
 	
\end{enumerate}


\section{建立自己的Zotero文献库}\label{sec:newLibrary}
\subsection{设置文献库在硬盘上的位置} 
\begin{enumerate}
	\item 
	建立自己的Zotero文献库首先需要选择自己的将要建立文献库在硬盘上的位置，
	方法是在Zotero中依次点击\menu{Edit-Settings}，
	如\autoref{fig:ch1ZoteroPre1}所示。
	%data folder
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.4]{ch3ZoteroPre1}
		\caption{打开Zotero设置}
		\label{fig:ch1ZoteroPre1}
	\end{figure}
	
	\item 
	在弹出的Zotero Settings对话框中，点击\menu{Advanced}，再点击Files and Folders中Linked Attachment Base Directory后面的\menu{Choose...}，浏览选择
	我们存放全文文件夹。
	文献库在Zotero中默认的存贮位置为\winpath{C:\Users\<Your Name>\Zotero},
	最好我们不要将这些数据不要存放在系统盘，防止系统崩溃造成无法挽回的损失。
	点击Custom后面的\menu{Choose...}以将这个目录改为自己的文件夹，如\autoref{fig:ch3BaseDir}所示
	%data folder
	\begin{figure}[htbp]
		\centering
		\includegraphics[width=0.8\linewidth]{ch3BaseDir}
		\caption{Zotero文件夹设置}
		\label{fig:ch3BaseDir}
	\end{figure}
	\item \label{sec:creat_folder}
	设置完文献存贮位置后，最好还要在Zotero中根据自己的课题方向或文献的类型等建立不同的分类(文件夹)，
	方便对文献进行分类管理。
	建立分类(文件夹)的方法是在Zotero中依次点击\menu{File-New Collection...}，
	如\autoref{fig:ch1ZoteroNewColl1}所示，或是在Zotero左侧的\menu{My library}上右击，
	选择\menu{New Collection...}，
	在弹出的对话框中输入自己的分类名称，如\autoref{fig:ch1ZoteroNewColl2}所示。
	%New Collection
	\begin{figure}
		\centering
		\begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
			\centering
			\includegraphics[scale=0.4]{ch1ZoteroNewColl1}
			\caption{在Zotero中新建分类步骤1}
			\label{fig:ch1ZoteroNewColl1}
		\end{minipage}
		\hspace{1.5cm}
		\begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
			\centering
			\includegraphics[scale=0.4]{ch1ZoteroNewColl2}
			\caption{在Zotero中新建分类步骤2}
			\label{fig:ch1ZoteroNewColl2}
		\end{minipage}
	\end{figure}
	\item 
	然后就会看到Zotero左侧面板中出现了刚才新建的分类，
	如\autoref{fig:ch1ZoteroNewColl3}所示，可以通过此方法建立多个分类，
	而且可以通过在分类上右击，选择在分类下面再建立子分类，
	如\autoref{fig:ch1ZoteroNewColl4}所示\footnote{除了分类(文件夹之外)，还可以通过
		标签和关联对文献进行管理，见\cref{sec:tag}和
		\href{https://zhuanlan.zhihu.com/p/275707703}{Zotero分类、标签和关联的使用。}}，
	如果建立了多个分类（文件夹），在搜索文献结果中如何知道文献属于哪个或哪些文件夹呢？
	Windows操作系统中，用鼠标点击选中文献后，按住\menu{ctrl}，文献所属的文件夹（分类）就会高亮显示。
	其他操作系统的按钮为： \keys{Option} (macOS), 或\keys{Alt} (Linux)，详见
	\href{https://www.zotero.org/support/collections_and_tags#identifying_collections_an_item_is_in}{Zotero官方文档}。
	
	%New Collection2
	\begin{figure}[htbp]
		\begin{minipage}[t]{0.4\linewidth}
			\centering
			\includegraphics[scale=0.7]{ch1ZoteroNewColl3}
			\caption{在Zotero中新建分类结果}
			\label{fig:ch1ZoteroNewColl3}
		\end{minipage}
		\begin{minipage}[t]{0.7\linewidth}
			\centering
			\includegraphics[scale=0.45]{ch1ZoteroNewColl4}
			\caption{可以在Zotero分类中新建子分类}
			\label{fig:ch1ZoteroNewColl4}
		\end{minipage}
	\end{figure}
\end{enumerate}
\subsection{从网站导入题录及全文} \label{sec:ImportFromWeb}
有很多方式可以在Zotero库中添加文献条目，最方便的还是直接在网上数据库进行导入，
安装浏览器插件(扩展)的目的也正是为此。
浏览器上Zotero的图标会根据当前打开网页的文献类型而显示不同的图标，
默认如\autoref{fig:ch1ZoteroIcon}显示,
当前网页含有多条文献时显示为文件夹图标，如果是学位论文则显示学位帽图标。
Zotero的这种自动感知功能十分强大，
期刊的网页我目前还没有碰到过不能感知的。实际上自动感知所支持的网页还有Amazon，Nytimes等，
而且Zotero支持的网页数目还在持续增长。
Zotero支持现在常见的网络数据库，如\href{https://www.sciencedirect.com/}{ScienceDirect}、\href{https://link.springer.com/}{Springer}及\href{https://pubmed.ncbi.nlm.nih.gov/}{PubMed}文献数据库等。我们仅以\href{https://www.sciencedirect.com/}{ScienceDirect}数据库、
\href{www.cnki.net}{中国知网CNKI}和\href{https://scholar.google.cz/schhp?hl=zh-CN}{Google Scholar}为例看一下。
\subsubsection{ScienceDirect文献导入}
完全打开\href{https://www.sciencedirect.com/}{ScienceDirect}上某篇文章网页，鼠标指向Zotero在浏览器中的图标时，
会提示：\menu{Save to Zotero (ScienceDirect)}, 如\autoref{fig:ch1SDImport}。
一般括号中会显示当前文献所属的数据库或期刊名称。
此时，点击这个图标，这篇文献就会导入到Zotero库中，如\autoref{fig:ch1SDRef}。
比较吸引人的是，如果有这个数据库(期刊)的权限，
这个篇对应的PDF会同时下载下来\footnote{\href{https://www.sciencedirect.com/}{ScienceDirect}使用了一些反机器人保护措施，因此在下载PDF全文时会弹出提醒对话框，验证非机器人操作，点击对话框中的方框即可。}，而且链接到这篇文献，在Zotero文献库中双击这个条目，
则系统会自动调用PDF阅读器打开这篇文献，
是不是很方便\footnote{一般情况下会调用操作系统默认地打开PDF的软件来打开PDF附件，
	如果需要修改打开PDF附件的软件，请参阅\cref{sec:open_PDF}}？
如果打开文献网页时鼠标指向Zotero在浏览器中的图标时提示
\menu{Save to Zotero (Web Page with snapshot)}，
原因是网页还没有完全打开，稍等一会儿或是刷新网页等显示正常了再导入。
%SD import
\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.9\linewidth]{ch1SDImport}
	\caption{导入\href{https://www.sciencedirect.com/}{ScienceDirect}数据库时的提示}
	\label{fig:ch1SDImport}
\end{figure}
%SD ref
\begin{figure}
	\centering
	\includegraphics[width=0.9\linewidth]{ch1SDRef}
	\caption{导入的\href{https://www.sciencedirect.com/}{ScienceDirect}文献在Zotero库中的显示结果}
	\label{fig:ch1SDRef}
\end{figure}
\subsubsection{中国知网文献导入} \label{sec:cnki}
在中国知网主页\url{http://www.cnki.net/}搜索结果中点击具体的文献，
打开文献的页面，此时鼠标移向Zotero在浏览器中的图标时，提示\menu{Save to Zotero (CNKI)},
如\autoref{fig:ch1CNKIImport},点击这个图标，对应的文献就会导入到Zotero库中，如果有权限，
对应的全文CAJ或PDF会一起导入\footnote{但此功能不稳定，可能会因为\href{www.cnki.net}{中国知网}的升级而失效。}。如果\url{http://www.cnki.net/}
这个网站不好用，可以试试\url{http://epub.cnki.net/kns/default.htm}。

如果你在中国知网检索文献时发现题录无法识别（识别为网页），请确认你是否是在校外通过
VPN登录访问的\href{www.cnki.net}{中国知网}， 如果是这种情况，请到
\url{https://github.com/Zotero-CN/translators_CN}下载新的
\href{https://github.com/Zotero-CN/translators_CN}{cnki.js}并替换电脑上旧的
针对于中国知网的translator \href{https://github.com/Zotero-CN/translators_CN}
{cnki.js}，或是通过茉莉花插件来更新
\href{https://github.com/Zotero-CN/translators_CN}{cnki.js}，
详见\cref{sec:cnki_fulltext}，或是设置一下浏览器详见
\href{https://zhuanlan.zhihu.com/p/110731827}{如何在家愉快地使用Zotero通过远程访问收集知网数据}。最好的办法是
通过\href{ http://fsso.cnki.net}{http://fsso.cnki.net中国知网高校/机构外部访问系统}选择自己
的学校或机构后，点击\menu{前往}，而后输入自己在学校或机构的账号、密码，点击\menu{登录}，或许
还需要点击\menu{Accept}同意一些条款，然后浏览器会重新定向到
\href{www.cnki.net}{https://www.cnki.net/}，使用就和在学校一样了，当然有
些学校或机构可能没有在\href{www.cnki.net}{https://www.cnki.net/}列表上，只能
用上面的其它办法了，在家使用知网也参见
\href{https://zhuanlan.zhihu.com/p/351547307}{Zotero CNKI翻译器更新(适合在家使用知网)}。
%CNKI import
\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.7\linewidth]{ch1CNKIImport}
	\caption{导入的\href{www.cnki.net}{中国知网}数据库时的提示}
	\label{fig:ch1CNKIImport}
\end{figure}
\subsubsection{通过Google Scholar导入文献}
在\href{https://scholar.google.cz/schhp?hl=zh-CN}{Google Scholar}搜索结果页面中，Zotero在浏览器中图标会变成一个文件夹图标，
点击这个小图标，在显示的页面中我们可以选择需要的条目，然后点击\menu{OK}，如\autoref{fig:ch1googlescholar}所示，
我们选择的条目就会自动导入的Zotero库中。
但是Zotero的浏览器插件不支持\href{https://scholar.google.cz/schhp?hl=zh-CN}{Google Scholar}的一些镜像网站(如\url{https://scholar.glgoo.org/})。
%谷歌学术 import
\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.8\linewidth]{ch1googlescholar}
	\caption{\href{https://scholar.google.com}{Google Scholar}文献导入}
	\label{fig:ch1googlescholar}
\end{figure}

\subsection{通过文献标识符导入题录}
如果已知文献的ISBN、DOI、PMID或arXiv ID，
可以通过文献标识符导入到Zotero库中，在Zotero中，点击魔术棒，
输入这些ID，如DOI：10.1016/j.meatsci.2016.03.026，
如\autoref{fig:DOI}所示，然后按\keys{回车键}，则对应的文献就会被导入到库中，
注意如用这种方式导入文献需要保持互联网畅通\footnote{当前输入中文文献的DOI等标识符还不能有效识别。}。
%DOI import
\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.7\linewidth]{ch1DOI}
	\caption{通过DOI导入文献}
	\label{fig:DOI}
\end{figure}


\subsection{已有PDF文献的导入} \label{sec:EngPDFIm}
对于以前下载的PDF文献，Zotero也可以很方便地提取PDF的元
信息(这里PDF的导入是指英文的PDF文件，
中文PDF的导入方式见\cref{sec:Chinese_PDF}),同时把此PDF作为附件链接到这篇文献中。
已有PDF文献导入的方式是将PDF直接拖入到Zotero的空白处，或两个条目中间，直到显示一条短线，放开鼠标。
如\autoref{fig:ch1PDFImport}所示，
Zotero会自动提取该PDF文件元数据(如文章的作者、题目、年代等信息)，添加此PDF对应的题录到Zotero中，并且将此PDF作为条目的附件，
如\autoref{fig:ch1PDFImport1}所示。如果拖动PDF到条目上放开鼠标，此PDF将会作为条目的附件导入。
%PDF import
\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.7\linewidth]{ch1PDFImport}
	\caption{直接将PDF文件插入到Zotero中}
	\label{fig:ch1PDFImport}
\end{figure}
\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.7\linewidth]{ch1PDFImport1}
	\caption{Zotero提取PDF元数据}
	\label{fig:ch1PDFImport1}
\end{figure}

\subsection{从其他文献管理软件导入}\label{OtherRefSoft}
如果以前用其他文献管理软件或是从其他人的Zotero库中导入，
Zotero可以方便地导入。首先，从其他文献管理软件导出BibTex、RIS或Zotero RDF格式。
然后，在Zotero中点击\menu{File-Import}，
如\autoref{fig:ch1ImportFromOther}所示
，根据提示找到导出的文件即可将那些文献导入到Zotero中。
%imort from other software
\begin{figure}
	\centering
	\begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
		\centering
		\includegraphics[scale = 0.6]{ch1ImportFromOther}
		\caption{导入其他文献管理软件数据}
		\label{fig:ch1ImportFromOther}
	\end{minipage}	
	%Manual New refence
	\hspace{2cm}
	\begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
		\centering
		\includegraphics[scale = 0.6]{ch1ManualNew}
		\caption{Zotero中手动添加新文献}
		\label{fig:ch1ManualNew}
	\end{minipage}	
\end{figure}

\subsection{手动录入题录}\label{sec:ManualImport}
对于那些不能从网上找到的文献，如一些老的文献、国家标准、
会议论文等，只能手动录入文献的信息。手动新建文献的方法是：
在Zotero界面中点击New Item图标或\menu{File-New Item}，
选择正确的文献类型，如\autoref{fig:ch1ManualNew}所示，
然后在Zotero右侧填入文献对应的信息，如：题目、作者、年代等信息，
如\autoref{fig:ch1ManualNewBook}所示。
%Manual New refence
\begin{figure}
	\centering
	\begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
		\centering
		\includegraphics[scale = 0.5]{ch1ManualNewBook}
		\caption{Zotero中新建书籍}
		\label{fig:ch1ManualNewBook}
	\end{minipage}	
	\hspace{2cm}
	%	%link file 
	\begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
		\centering
		\includegraphics[scale = 0.8]{ch1LinkFile1}
		\caption{Zotero中链接文献}
		\label{fig:ch1LinkFile1}
	\end{minipage}	
\end{figure}
%link file2
\begin{figure}
	\centering
	\includegraphics[width=0.8\linewidth]{ch1LinkFile2}
	\caption{通过右击Zotero中链接文献}
	\label{fig:ch1LinkFile2}
\end{figure}


\subsection{链接全文}\label{sec:linkFulltex}
对于从其他网站下载的全文或其他附件信息，
我们可以手动链接到参考文献条目中，先选中对应的参考文献条目
，在Zotero中点击Add Attachment图标，
选择\menu{Attach File ...}，
如\autoref{fig:ch1LinkFile1}所示，找到相应的附件。
或在条目上右击，选择\menu{Add Attachment-File}，如\autoref{fig:ch1LinkFile2}所示，
后续步骤与前述相同。链接上附件后，原来存的文件可以删除。

\subsection{Zotero 修改打开附件（PDF）的阅读器的方法}\label{sec:chang_pdf_browser}

在Zotero 中内置了打开PDF的阅读器，按\cref{sec:linkFulltex}链接了全文后，
双击条目或PDF默认情况会调用其内置的PDF阅读器打开附件，
但是在内置的PDF阅读器做的标记、笔记，
用其它PDF阅读器
（如将PDF文件分享给他人后）打开后，
里面的标记、笔记会消失，只能在内置阅读器中
点击\menu{File-Save As...}另存为其它PDF
时，
再用其它阅读器打开才可以保留标记、笔记，
如果不习惯，可以设置用系统默认的或自定义PDF阅读器。步骤如下：

在Zotero依次点击\menu{Edit-Settings-General}，
在Reader下面，点击Open PDFs Using后面的选择框，
点击 \menu{System Default}即可使用系统默认的PDF阅读器，
也可以点击\menu{Custom....}，找到自定义的其它打开PDF的程序
，如\autoref{fig:ch1customPDFBrowser}所示。

	%link file2
	\begin{figure}
		\centering
		\includegraphics[width=0.8\linewidth]{ch1customPDFBrowser}
		\caption{自定义打开PDF的软件}
		\label{fig:ch1customPDFBrowser}
	\end{figure}
	
	
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.6]{ch4attangerOpen}
		\caption{使用\href{https://github.com/MuiseDestiny/zotero-attanger}{Zotero Attanger}自定义打开PDF的软件}
		\label{fig:ch4attangerOpen}
	\end{figure}

安装\href{https://github.com/MuiseDestiny/zotero-attanger}{Zotero Attanger}插件后，右击PDF附件，也可以选择使用什么软件打开附件，如\autoref{fig:ch4attangerOpen}所示，更详细的介绍也可参见\href{https://zhuanlan.zhihu.com/p/373952017}
{Zotero如何设置打开PDF附件的软件}。


\subsection{删除（合并）重复文献}\label{sec:delDup}
从多个不同数据库导入的文献可能会有重复，即两个条目完全相同，这时就需要手动删除重复文献。
Zotero允许一个条目同时存在于多个分类（文件夹）中，这种情况不属于重复文献。删除重复文献的方法
是点击Zotero左侧的\menu{Duplicate Items}，检测到的重复文献就会出现中间的面板中，
点击其中一条文献，与之重复的文献就会全部被选中，右侧面板中显示重复文献的情况。选择其中一条
作为主条目，再点击\menu{Merge * items}，重复文献就会被删除（合并），
如\autoref{fig:ch1MergeDup}所示。如果删除（合并）多条重复文献，在点击选中条目后，按
\keys{Ctrl+A}或点击\menu{Edit-Select All}选中所有重复文献，
再点击\menu{Merge * items}即可，或使用\href{https://chenglongma.com/zoplicate/}{Zoplicate}插件更智能地处理重复条目，它可以检测重复条目、批量处理重复条目、标记“非重复条目”、显示重复条目统计信息，也可以使用JavaScript脚本批量删除（合并）重复文献，
见\cref{sec:DelDupBatch}。如何选中重复条目中的某条文献见\cref{sec:selectDup}。

%删除重复文献
\begin{figure}[htbp]
	\centering
	\includegraphics[width=1.0\linewidth]{ch1MergeDup}
	\caption{删除（合并）重复文献}
	\label{fig:ch1MergeDup}
\end{figure}

\subsection{展开和折叠所有条目的方法}\label{sec:fold_collapse_item}
如果想一次展开所有条目以查看条目的附件或笔记，每次都用鼠标来点击三角有些麻烦，可以用快捷键来展开和折叠。

展开所有条目：\keys{Shift+=} （如果有数字小键盘，可以直接按\menu{+} ）。

 折叠所有条目：\keys{-}

操作见\href{https://zhuanlan.zhihu.com/p/544153534}{如何展开和折叠所有条目？}



\chapter{在Word中写作时用Zotero插入参考文献}\label{ch:insert}
建立了自己的Zotero文献库后，
在写文章尤其是综述类的文章时就可以方便地利用Zotero插入文献了。
现在Zotero对于Libre Office中的Writer和MS Office中的Word支持比较好。
尽管在WPS中会出现Zotero的工具条，但在插入文献时会出现错误。
本文以Word 2021为例进行讲述。如果安装正确的话，在Word中会形成Zotero的工具条，
如\autoref{fig:ch2ZotoeroTool}所示，
主要操作在这个工具条中进行。
如果在Word中没有出现Zotero的工具条，可以尝试用\cref{sec:tool_bar}的方法解决。
%tool bar
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.6]{ch2ZotoeroTool}
	\caption{Zotero在Word中工具条}
	\label{fig:ch2ZotoeroTool}
\end{figure}

\section{插入参考文献}\label{sec:insertRef}
我们在写文章时，尤其是文章的前言或数据的分析讨论部分及在综述类的文章中往往需要插入参考文献，
在Word中插入Zotero管理的参考文献的方法比较简单，步骤如下：
\begin{enumerate}
	\item
	首先打开Zotero，然后点击Zotero在Word工具条中的第一个按钮\menu{Add/Edit Citation}，
	在弹出的对话框中选择需要的Style(一般是期刊或数据库的名称)，
	点击\menu{OK}，如\autoref{fig:ch2WordInsert}所示。
	%select style
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.6]{ch2WordInsert}
		\caption{选择需要的Style}
		\label{fig:ch2WordInsert}
	\end{figure}
	\item
	如果列表中没有需要的格式\label{tag:notyle}，
	点击\autoref{fig:ch2WordInsert}中的\menu{Manage Styles...}，
	弹出\menu{Zotero Preferences}对话框，
	如\autoref{fig:ch2ZoteroPre}所示。
	%Zotero Preferences
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.6]{ch2ZoteroPre}
		\caption{Zotero Preferences}
		\label{fig:ch2ZoteroPre}
	\end{figure}
	\item
	点击\autoref{fig:ch2ZoteroPre}中\menu{+}，
	找到从其它地方得到的csl文件。
	或是点击\menu{Get additional styles...}，则会打开Zotero的Style仓库，
	从中搜索我们需要的期刊，如meat science，
	在得到的结果点击需要的期刊格式，
	这个Style文件就会加入到Zotero Style管理器中，以后可以直接调用，
	如\autoref{fig:ch2ZoteroStyle}所示,
	返回到\autoref{fig:ch2WordInsert}，点击\menu{OK}。
	%lZotero仓库
	\begin{figure}[htbp]
		\centering
		\includegraphics[width=0.7\linewidth]{ch2ZoteroStyle}
		\caption{Zotero Style仓库}
		\label{fig:ch2ZoteroStyle}
	\end{figure}
	\item
	接着会出现搜索框，可以在搜索框输入关键词，
	如文章的作者，年代，题目等，以个人经验，
	输入文章的题目搜索的结果最为准确，点击搜索结果我们希望插入的文献，
	如\autoref{fig:ch2ZoteroSearch}所示，
	然后再按\keys{回车键}或点击\arrowkeyright，则选择的文献就会插入到Word中。
	%搜索Zotero库
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.45]{ch2ZoteroSearch}
		\caption{搜索Zotero文献库}
		\label{fig:ch2ZoteroSearch}
	\end{figure}
	\item
	但参考文献现在只是插入到正文中，还没有出现文末的参考文献列表，
	要想显示它，首先将鼠标点击该Word文档的末尾，
	然后点击Zotero在Word中工具条中的第二个按钮\menu{Add/Edit Bibliography}，
	刚插入的文献最会显示在文档的末尾，
	显示的格式就是我们在\autoref{fig:ch2WordInsert}选择的Style规定的格式，
	如\autoref{fig:ch2Bibliography}所示,
	仅需第一次点击这个\menu{Add/Edit Bibliography}按钮，
	后面在添加、删除其他文献时，正文的引用及文末的参考文献列表最自动更新，
	是不是很方便？可以按相同的方法插入其他文献
	\footnote{如果觉得通过搜索的方式插入文献不方便可以切换到\menu{经典视图}，
		见\cref{sec:classView}。}。
	
	%文末文献
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.40]{ch2Bibliography}
		\caption{插入文末参考文献的方法}
		\label{fig:ch2Bibliography}
	\end{figure}
\end{enumerate}

\section{删除参考文献及调整参考文献的顺序}
删除参考文献的方法比较简单，在正文中点击不需要文献，
此时文献的背景会变为灰色，选择不需要文献，剪切或删除就可以了，
文末的参考文献列表会自动更新。
如果需要删除的文献的地方引用了多条文献，
则用鼠标点击引用多条文献的地方，然后点击Zotero在Word工具条中的第一个按钮\menu{Add/Edit Citation},
在弹出的对话框中删除不需要的文献即可，
如\autoref{fig:ch2MultiRef}所示,当然单条参考文献的删除也可以用这个方法。

调整参考文献顺序的方法是，
将正文中的包括文献引用的部分剪切到合适的部分即可，文末的参考文献列表会自动更新，
如果没有自动更新点击Zotero在Word工具条中\menu{Refresh}按钮，
也可以参照\cref{sec:norefresh}打开自动更新。

%删除文献
\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.9\linewidth]{ch2MultiRef}
	\caption{删除参考文献的方法}
	\label{fig:ch2MultiRef}
\end{figure}

\section{切换Style}\label{sec:changeStyle}
尽管不愿意看到，但被期刊拒稿也是常见的事情，
这时就需要修改后重新投稿，不同期刊往往正文中的引用和文末的参考文献列表格式要求不一样，
文献重投时就需要换另外一个期刊的Style。
换style的方法也比较简单，
只需要点击Zotero在Word工具条中的\keys{Document Preferences}按钮，
在列表中选择合适的期刊就可以，
如\autoref{fig:ch2ChangeStyle}所示，如果列表没有我们需要的期刊格式，
参见\cpageref{tag:notyle}\cref{sec:insertRef}。
%change style
\begin{figure}
	\centering
	\includegraphics[width=0.9\linewidth]{ch2ChangeStyle}
	\caption{切换Style}
	\label{fig:ch2ChangeStyle}
\end{figure}
%添加本地csl文件
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.45]{ch2addStyle}
	\caption{添加本地csl文件}
	\label{fig:ch2addStyle}
\end{figure}

\section{添加本地csl文件}\label{sec:addStyle}
如果Zotero仓库没有需要的参考文献格式，可以到\href{https://zotero-chinese.com/styles/}{Zotero中文社区中文CSL样式版块}找找有类似的中文期刊和国内一些大学的学位论文样式，或是自己进行编辑Style文件，Zotero中提供了编辑Style文件的方法，
在\url{http://editor.citationstyles.org/visualEditor/}网站上可以进行在线编辑csl文件，而后下载，同时也可以在这个网站上搜索需要的Style文件，
可以先选择格式比较接近的期刊格式，再进行编辑，详情见\href{https://zhuanlan.zhihu.com/p/336009544}{style csl文件简单编辑}。但总体上相对 Endnote的编辑格式文件而言，编辑csl文件比较复杂，如果需要可以自行百度或Google方法，或在论坛及QQ群求助。

从在线编辑网站或从其他人那得到csl文件后，需要添加到本地Style目录，在格式化参考文献时才可以使用。
添加的方法是依次点击\menu{Edit-Settings-Cite},点击Style Mangager中右下角的\menu{+}，
如\autoref{fig:ch2addStyle}所示，找到自己的csl文件，再点击\menu{打开}即可。

在添加\href{https://zotero-chinese.com/styles/}{Zotero中文社区中文CSL样式}时有可能会提示“xxx.csl 不是一个有效的 CSL 1.0.2 样式文件，你可能不能和 Zotero 一起正常工作。”，如\autoref{fig:ch2invalidcsl}所示，这是因为该样式使用了 \href{https://github.com/Juris-M/citeproc-js}{citeproc-js} 提供的 \href{https://citeproc-js.readthedocs.io/en/latest/csl-m/index.html}{CSL-M} 扩展功能，属于正常现象，点击的\menu{OK}直接忽略即可。
%ch2invalidcsl
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.5]{ch2invalidcsl}
	\caption{不是一个有效的 CSL 1.0.2 样式文件提示}
	\label{fig:ch2invalidcsl}
\end{figure}


%remove field codes
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.5]{ch2Unlink}
	\caption{去除域代码}
	\label{fig:ch2Unlink}
\end{figure}

\section{去除域代码}\label{sec:Remove_field}
插入到正文的中的参考文献引用及文末的参考文献列表是以域代码的形式存在于Word文档中的，在投稿之前可以去除这些域代码，\textbf{\emph{注意去除域代码操作不可撤消，操作之前一定要谨慎！！！}}
去除后这些参考文献与其他正文显示就没有区别了，去除的方法是，首先将文件另存一个其它文件作为备份，
然后点击Zotero在Word工具条中的\menu{Unlink Citations}，再点击确定,
如\autoref{fig:ch2Unlink}所示。需要注意的是去除域代码后，再插入或删除参考文献列表就不会再自动更新了，而且再用Zotero插入的文献会自动重新编号，要想在原来基础上更新，
只能在还保留域代码的文件中进行操作。


\section{使用GB/T 7714 2015 样式期刊类型显示为[Z]的原因及解决方法}\label{sec:GBShowZ}
正常情况下，文献类型为Journal Article期刊文章使用GB/T 7714 2015 样式文件(如\href{https://zotero-chinese.com/styles/gb-t-7714-2015-numeric-bilingual/}{GB/T 7714—2015（顺序编码，双语）})时文章类型标识应该显示为[J]，今天碰到一个网友的却显示为[Z]，形如：
	\begin{lstlisting}[language=HTML]
	[1] 田书欣, 程浩忠, 曾平良, 等. 大型集群风电接入输电系统规划研究综述[Z]//中国电机工程学报: v.34;No.489. 2014: 1566-1574.
	\end{lstlisting}
经过检查发现，其条目的Extra字段包括如下内容：\verb|type: 10.13334/j.0258-8013.pcsee.2014.10.007|，而在csl中，标识符识别的宏为：
	\begin{lstlisting}[language=XML]	
		<!-- 文献类型标识 -->
		<macro name="type-code">
		...
		<else-if type="article-journal article-magazine" match="any">
		<text value="J"/>
		</else-if>
		<else-if type="article-newspaper">
		<text value="N"/>
		...
		<else>
		<text value="Z"/>
		</else>
		...
		</macro>
	\end{lstlisting}
因此，csl调用了Extra中的文献类型信息：\verb|type: 10.13334/j.0258-8013.pcsee.2014.10.007|是标识为[Z]的原因，而这个 \verb|10.13334/j.0258-8013.pcsee.2014.10.007|在csl中是不没有对应文献类型的，所以文献标识符取值成了[Z]。

明白了原理，解决方法就比较简单了，将Extra字段清空，然后在Word中刷新文献即可。当然只把type:这个删除也可以。清除后显示为（当前条目的卷也是有问题的，要完全显示正常修改条目中的卷即可），最终显示为：
	\begin{lstlisting}[language=HTML]
		[1] 田书欣, 程浩忠, 曾平良, 等. 大型集群风电接入输电系统规划研究综述[J]. 中国电机工程学报, 2014, v.34;No.489(10): 1566-1574.
	\end{lstlisting}
	
	可以安装\href{https://github.com/redleafnew/zotero-updateifs}{Green Forg}插件支持批量Extra清空。
	
\chapter[利用坚果云同步全文]{利用坚果云同步全文\footnote{如果没有在不同电脑同步题录和全文的需要，本章可以略过。}}\label{ch:syn}		
需要在不同电脑上阅读文献及写作的人有同步的需要。另外，如果出于对题录信息和全文备份的需要，也可以使用同步。在本章我们使用Zotero来同步题录信息，使用坚果云来同步全文信息。

\section{注册Zotero用户}\label{sec:zotReg}
使用Zotero来同步题录信息需要注册Zotero用户，注册的网址是\url{https://www.zotero.org/user/register}，注册的流程与一般网站注册用户差别不大，
填入用户名，Email，密码等，然后点击进行人机身份验证前的方框，
根据提示完成后续步骤，最后点击 \menu{Register}完成注册，
如\autoref{fig:ch3Register}所示。注册完成后网站提示：
Thanks for registering. We’ve sent an email to activate your account.
而后查收邮箱，会收到如下内容的邮件：Thanks for signing up for a zotero.org account! Please confirm your email address 
by clicking on the following link or pasting it into your browser: 
\url{https://www.zotero.org/user/validate/1ab18fc52bb2b7ba6ddb},validate后面的内容会有差异，
将这些地址复制到浏览器地址栏，按回车，如果页面显示：Success! You registered your Zotero account!则邮箱验证成功。
如果收件箱内没有收到邮件，可以到垃圾邮件内找找，有可能这封邮件被邮件系统误认为是垃圾邮件了。不进行激活也可以使用，
但是无法创建群组(创建群组见\cref{sec:CreatGroup})。值得注意的是，注册Zotero用户时需要翻墙，
因为这个网站需要调用Google的人机身份验证，如果不翻墙的话，
无法完成注册\footnote{20211003现在好像不需要翻墙也可以注册Zotero账户了。}，
当然也可以请国外的亲朋好友帮忙注册用户。
完成Zotero用户注册以后还需要在Zotero登录才能进行题录信息的同步，登录的方法见\cref{sec:syn}。
%register zotero
\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.3\linewidth]{ch3Register}
	\caption{注册Zotero界面}
	\label{fig:ch3Register}
\end{figure}

\section{坚果云注册及设置}\label{sec:jianguoReg}
注册坚果云的目的主要是为了同步全文，Zotero也提供了同步全文的空间，
免费的空间只有300M，2G空间的年使用费为20\$，
如果是土豪可以选择使用Zotero来同步全文，
也算是为开源社区做点贡献，支持Zotero的发展。
另外一个可供选择的方法是使用Zotero来同步题录(Zotero提供的同步题录的空间貌似是无限的)，
而使用同步盘来同步全文，
可以使用国外的\href{https://office.live.com/start/OneDrive.aspx}{OneDrive}、
\href{https://infini-cloud.net/en/index.html}{infiniCLOUD}、
\href{https://www.dropbox.com/}{Dropbox}、
\href{https://www.google.com/drive/}{Google Drive}、\href{https://mega.nz/}{MEGASync}等同步盘来完成，
但这些同步盘(网盘)要么在国内无法访问，要么速度比较慢，所以我们只能选择国内的同步盘来完成。 
这里推荐使用坚果云同步盘，这个同步盘也支持多个操作系统，它可以还提供WebDAV的方式进行访问，对于普通用户，
它提供每个月1G的上传流量，3G的下载流量，超过以后停止上传或下载，到下个月后自动恢复，这些流量对于一般的用户也足够了。
\begin{enumerate}
	\item 根据自己的操作系统到\url{https://www.jianguoyun.com/s/downloads}下载相应的客户端，
	并进行安装，
	安装过程与其他程序大同小异，在此不再赘述。安装完成以后，在系统托盘中会出现一个坚果的图标。
	如果没有图标，可以到坚果云的安装目录中双击Nutstore.exe运行坚果云同步盘，
	运行后需要注册一个坚果云的用户，
	如\autoref{fig:ch3JianguoRe}所示，填入需要Email、
	密码及昵称等信息，如\autoref{fig:ch3JianguoReg2}所示，
	点击\menu{下一步}，可能还需要手机验证。
	后续还需要设置的文献贮存的地址，如\autoref{fig:ch3JianguoReg3}所示，
	然后关闭此窗口。
	当然也可以在坚果云的网站\url{https://www.jianguoyun.com/d/signup}上注册用户,
	然后在\autoref{fig:ch3JianguoRe}点击\menu{登录}，
	登录完毕后再设置需要同步的目录。
	
	%Jianguo reg
	\begin{figure}[htbp]
		\centering
		\begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
			\centering
			\includegraphics[scale=0.5]{ch3JianguoRe}
			\caption{坚果云用户注册步骤1}
			\label{fig:ch3JianguoRe}
		\end{minipage}
		%\hspace{1cm}
		%Jianguo reg2
		\centering
		\begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
			\centering
			\includegraphics[scale=0.5]{ch3JianguoReg2}
			\caption{坚果云用户注册步骤2}
			\label{fig:ch3JianguoReg2}
		\end{minipage}	
	\end{figure}
	
	
	
	\item 此时，将文件或文件夹复制到\autoref{fig:ch3JianguoReg3}的所设置的文件内，
	坚果云就会将文件同步到坚果云的服务器上，
	如果在其他电脑上登录坚果云的同一用户客户端后，
	坚果云会自动将这些文件或文件夹同步到本地。
	%Jianguo reg3
	\begin{figure}
		\centering
		\includegraphics[scale=0.5]{ch3JianguoReg3}
		\caption{坚果云用户注册步骤3}
		\label{fig:ch3JianguoReg3}
		
	\end{figure}
	\item  因为同步文献全文的需要，
	我们需要将同步的文件夹设置我们在\autoref{fig:ch3BaseDir}中设置的附件存放的位置，
	即图中Base directory的路径，
	如\winpath{E:\Jianguo\references}；在Windows资源管理器中
	找到\winpath{references}，在\winpath{references}上右击，
	选择\menu{坚果云-同步该文件夹}，如\autoref{fig:ch4JianguoAdd}所示；
	在接下来的两个对话框中点击
	\menu{完成}，正常情况下\winpath{references}左下角会出现绿色
	对勾表示同步完成，若左下角出现蓝色圆圈则表示正在同步。
	当然也可以直接将\winpath{references}目录剪切到
	\autoref{fig:ch3JianguoReg3}目录中，
	但是需要在Zotero中
	将Base directory（见\cref{sec:newLibrary}）
	和\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}的附件存在的位置也设为这个目录（见\cref{sec:AttangerPre}）。
	%Jianguosyn change folder
	\begin{figure}[htbp]
		\centering
		\includegraphics[width=0.5\linewidth]{ch4JianguoAdd}
		\caption{将references文件夹加入到同步中}
		\label{fig:ch4JianguoAdd}
	\end{figure}
	\item 在新的需要同步的另一台电脑上，同样安装上坚果云软件，登录后，默认的
	reference文件夹放在了\autoref{fig:ch3JianguoReg3}的目录中，在Zotero中
	将Base directory（见\cref{sec:newLibrary}）
	和\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}的附件存放位置也设为这个目录（见\cref{sec:AttangerPre}）， 
	两个电脑之间包括参考文献条目和附件就可以同步了。
	\end{enumerate}

坚果云的其他问题可以访问\url{http://help.jianguoyun.com/}查找解决方法。

\section{Zotero中同步设置}\label{sec:syn}
	Zotero中的同步设置包括题录同步和全文同步，
我们使用Zotero提供的帐号进行题录同步，利用坚果云进行全文同步。
\begin{enumerate}
	\item 
	在需要同步的电脑Zotero中依次点击\menu{Edit-Settings}，如\autoref{fig:ch3ZoteroPre1}所示。
	\item
	在弹出的Zotero Settings对话框中点击\menu{Sync}，
	然后在Setting中输入\cref{sec:zotReg}中申请的Zotero的用户名和密码后，
	点击\menu{Set Up Syncing}，如\autoref{fig:ch3ZoteroPre2}所示。
	%zotfile install2-3
	\begin{figure}[t]
		\centering
		\begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
			\centering
			\includegraphics[scale=0.53]{ch3ZoteroPre1}
			\caption{打开Zotero设置}
			\label{fig:ch3ZoteroPre1}
		\end{minipage}
		\begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
			\centering
			\includegraphics[scale=0.5]{ch3ZoteroPre2}
			\caption{Zotero同步设置1}
			\label{fig:ch3ZoteroPre2}
		\end{minipage}
	\end{figure}
	\item
	如果输入的用户名、密码正确，会弹出文件同步的选项，
	点击\menu{Sync automatically}和\menu{Sync {full-text} content}
	前面的方框使之选中，\menu{File Syncing}下面的两个选项不要选中，
	如\autoref{fig:ch3ZoteroPre3}所示，因为Zotero提供的全文同步空间有限，
	我们在\cref{sec:jianguoReg}中设置了用坚果云同步全文，但此时Zotero还不能同步全文到其他电脑，
	还需要使\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}插件将全文附件自动复制到坚果云的同步盘中，
	见\cref{sec:AttangerPre}。
	\item				  	
	也可以利用坚果云提供的WebDAV服务同步全文，方法见\url{http://help.jianguoyun.com/?p=3168},
	简书文章\url{https://www.jianshu.com/p/e7f5c3e95cf4}。			  
	%zotfile install5
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch3ZoteroPre3}
		\caption{Zotero同步设置2}
		\label{fig:ch3ZoteroPre3}
	\end{figure}
\end{enumerate}

\section{\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}插件设置}\label{sec:AttangerPre}
Zotero可以对题录的全文进行管理，在链接上全文以后，Zotero会将全文复制到其数据文件夹(数据文件夹在\cref{sec:data_dir}提到)
的\winpath{storage}文件夹下的一些名字比较奇怪的文件夹下，对于全文的查找和管理带来不便，因此推荐使用\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}插件来进行管理，从而方便地利用坚果云对全文进行同步，\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}的安装见\cref{sec:installPlug}\footnote{\href{https://github.com/wileyyugioh/zotmoov}{ZotMoov}插件具有类似功能，也可以尝试。}。
\begin{enumerate}
	\item 在Zotero中依次点击\menu{Edit-Settings-Attanger}。
	%attanger设置
	\begin{figure}[t]
		\centering
		\includegraphics[scale=0.5]{ch3AttangerPre1}
		\caption{打开Attanger设置}
		\label{fig:ch3AttangerPre1}
	\end{figure}
	
	\begin{figure}[t]
		\centering
		\includegraphics[scale=0.5]{ch3AttangerRename}
		\caption{Attanger重命名和移动}
		\label{fig:ch3AttangerRename}
	\end{figure}
	\item 点击Destination Path下面Root Directory的\menu{Choose}，
	选择坚果云中文献全文同步目录，其它选项保持默认，如\autoref{fig:ch3AttangerPre1}所示。
 
	\item 最后，对于文献库中存在的并且已经链接全文的题录，需要用\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}插件重新命名附件，不同电脑之间才会同步。
	在Zotero主界面中，用鼠标或按\keys{Ctrl+A}选中所有题录，然后右击依次点击
	\menu{Attachment Manager-Rename and Move Attachments}，
	如\autoref{fig:ch3AttangerRename}所示；
	\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}插件会根据默认的规则对附件进行重命名，并且剪切到以前设置的坚果云同步盘中，
	而且在Zotero会形成软链接，如\autoref{fig:ch3AttangerSoftLink}所示，
	完成此步骤后，坚果云就会将这些附件同步附件到服务器，在其他电脑会从服务器同步到本地。
	重命名这个步骤只需要对于已经存在于文献库中并且已经链接了全文的题录(见\cref{sec:linkFulltex})进行此操作，
	对于以后从网站下载题录时同时自动下载的附件和手动添加全文的题录\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}会自动进行重命名并且移动到坚果云同步目录
	\footnote{在需要同步的电脑都装上坚果云、\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}插件并按上述设置后应该就可以在不同电脑间进行同步了。}。
	%Attanger生成的软链接
	\begin{figure}[htbp]
		\centering
		\includegraphics[width=0.8\linewidth]{ch3AttangerSoftLink}
		\caption{Attanger生成的软链接}
		\label{fig:ch3AttangerSoftLink}
	\end{figure}
	
	\end{enumerate}

\section{设置\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}插件使其支持更多的文件类型}\label{sec:zotFile_more_filetype}
\quad \quad Zotero的\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}插件对附件的管理带来很大的方便，
但默认情况下\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}不支持重命名移动caj文件，
\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}默认仅支持pdf,doc,docx,txt,rtf,djvu,epub格式的文件进行重命名移动。
可以通过支持更多类型的文件，如从中国知网上下载的caj文件。方法是：

\quad \quad 在Zotero中依次点击\menu{Edit-Settings-Attanger}，
然后在Other Settings下，Types of Attachments for Renaming/Moving后的文本框中添加支持的文件类型，如添加“,caj”，
注意caj前面的英文逗号，而且caj后面没有标点，\autoref{fig:ch3AttangerMoreTypes}。
然后在Zotero中再进行重命名或添加caj
附件时就会重命名且移动到自定义的目录中了。


%Attanger支持更多类型
\begin{figure}[htbp]
	\centering
	\includegraphics[width=0.8\linewidth]{ch3AttangerMoreTypes}
	\caption{设置Attanger支持更多类型}
	\label{fig:ch3AttangerMoreTypes}
\end{figure}

\section{如何让不同主题的参考文献附件放在同一个文件夹}\label{sec:Attanger_dif_sub_folder}

我们在收集参考文献时经常需要收集不同主题的文章，如主题包括“3D打印”、“涂膜保鲜”等，
如何将不同主题的参考文献附件放在各自不同的文件夹呢，如将3D打印相关的附件放在\winpath{3d}文件夹，
涂膜保鲜的放在\winpath{film-preservation}文件夹。

我们可以结合Zotero的Collection和\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}插件的Subfolder参数来实现。

\begin{enumerate}
	\item 在Zotero中建立“3d” Collection（文件夹）：
	在Zotero中依次点击\menu{File-New Collection...}，
	如\autoref{fig:ch1ZoteroNewColl1}所示，或是在Zotero左侧的\menu{My library}上右击，
	选择\menu{New Collection...}，
	在弹出的对话框中输入自己的分类名称，如\autoref{fig:ch1ZoteroNewColl2}所示。

	\item 输入Collection的名字，如\winpath{3d}，同样建立其他的Collection。
	
 
	\item 	在Zotero中依次点击\menu{Edit-Settings-Attanger}，
	在弹出对话框中在，在Destination Path下面，Subfolder后面的文本框中输入“\{\{collection\}\}”（不含引号）
	，如\autoref{fig:ch3AttangerSubfolder}所示。
	
	%zotFile_clean-att
 	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.6]{ch3AttangerSubfolder}
		\caption{ZotFile常规设置中输入子文件夹定义}
		\label{fig:ch3AttangerSubfolder}
	\end{figure}
	\item 在导入文献时，将3D打印相关的文献都导入到这个Collection中，
	（文献的导入见\cref{sec:newLibrary}）
	如果设置了自动重命名，则导入的条目中的附件就会自动重命名，
	并且放到名字为第2步定义的Collection的子文件夹中（
	此子文件夹放在了\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}设置的
	Root Derectory目录中，
	\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger} Root Derectory设置见\cref{sec:AttangerPre}）。
	
	\item 如果没有自动重命名，则在条目上右击，选择\menu{Attachment Manager-Rename and Move Attachments}，
	如\autoref{fig:ch3AttangerRename}所示。	
	\item 最终效果如\autoref{fig:ch3zotRenameFinal}所示。
 
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.6]{ch3zotRenameFinal}
		\caption{按不同主题分类的附件最终显示效果}
		\label{fig:ch3zotRenameFinal}
	\end{figure}	
\end{enumerate}

\section{使用了\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}后如何将文件存贮位置恢复到Storage中？}\label{sec:zotFile_restore_storage}

如果使用了了\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}插件，经过前面章节设置（\cref{sec:AttangerPre}），会将文献附件统一移动到自定义文件夹里。
但如果某些插件只支持\winpath{Storage}中的文献，如何把自定义文件夹中的文献再恢复到\winpath{Storage}文件夹中呢？

\begin{enumerate}
	\item 在Zotero选中需要转存条目，依次点击\menu{Tools-Manage Attachments-Convert Linked Files to Stored Files...}，
	如\autoref{fig:ch3zotConFile}所示。
	\item 在弹出的对话框中根据自己的情况，如果要删除原位置的文件则选中\menu{Delete original file after storing}，
	然后点击\menu{Continue}，如\autoref{fig:ch3zotConFileConfirm}所示，注意：如果附件已经在其它程序中打开，需要将其关闭，否则转移可能会失败。
	\item 然后这些文件就会恢复到Zotero数据目录中的Storage文件夹中的8位字母的文件夹内。
\end{enumerate}

%zotFile_restore_storage
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.6]{ch3zotConFile}
	\caption{将链接文件转为存贮文件}
	\label{fig:ch3zotConFile}
\end{figure}

\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.6]{ch3zotConFileConfirm}
	\caption{选择转存后是否删除原文件}
	\label{fig:ch3zotConFileConfirm}
\end{figure}

\section{不用代码不用其它软件清理使用\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}后删除条目剩余的游离附件}\label{sec:zotFile_clean_att}

由于历史原因，之前使用\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}或Zotero 6.0的\href{http://zotfile.com/}{ZotFile}过程中已经删过一些条目，但是不确定附件是否也被删除了。
同时对数据文件夹下，没有在数据库中链接的附件进行清理。或是在附件文件夹中可能会存在一些空的文件夹。
如何删除这些文件或文件夹？网上可以找到一些方法包括：
Zotero不用安装其它软件清理删除条目后残留的PDF方法（见\url{https://zhuanlan.zhihu.com/p/356071795}），
Zotero库中参考文献条目删除后，清除残留PDF的python脚本（见\url{https://zhuanlan.zhihu.com/p/121770068}），
安装了\href{http://zotfile.com/}{ZotFile}后删除文献后清除PDF附件的小程序（见\url{https://zhuanlan.zhihu.com/p/109531298}）等，
这些方法或者是需要JavaScript或是需要Python脚本，运行过程也可能会出现错误，对于不太懂编程语言的人来说很痛苦。
近日从\url{https://github.com/jlegewie/zotfile/issues/96}的\href{https://github.com/jlegewie/zotfile/issues/96#issuecomment-505084568}{回复}中看到一个方法，可以只在Zotero中即可完成清理。
操作步骤如下：

\begin{enumerate}
	\item 先暂停同步：
	依次点击\menu{Edit-Settings-Sync}，然后点\menu{Snyc automatically}和\menu{Sync {full-text} content}前面的框，
	使都不要被选中。也可点击\menu{Unlink Account...}，退出账号，在弹出的对话框中点击\menu{Unlink Account}，如\autoref{fig:ch3disaSync}所示，
	注意不要点击\menu{Remove my Zotero data from this computer}前的方框，如\autoref{fig:ch3zotUnlinWaring}所示。
	
	%zotFile_clean-att
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.6]{ch3disaSync}
		\caption{暂停同步}
		\label{fig:ch3disaSync}
	\end{figure}
	
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.6]{ch3zotUnlinWaring}
		\caption{选择转存后是否删除原文件}
		\label{fig:ch3zotUnlinWaring}
	\end{figure}
	\item 在Zotero中依次点击\menu{Edit-Settings-Attanger}，点击Destination Path下面Root Directory的\menu{Choose}
	如\autoref{fig:ch3AttangerPre2}所示。
	
	%zotFile_clean-att
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.6]{ch3AttangerPre1}
		\caption{Attanger设置}
		\label{fig:ch3AttangerPre2}
	\end{figure}
	

	\item 然后选择一个新的目录，如\winpath{D:\att}，点击\menu{选择文件夹}，再返回的对话框中点击\menu{OK}，如\autoref{fig:ch3zotSlePath}所示。
	%zotFile_clean-att
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.6]{ch3zotSlePath}
		\caption{选择文件夹}
		\label{fig:ch3zotSlePath}
	\end{figure}
	
 
	\item 在Zotero中点击\menu{My Library}，然后在右侧详细信息中随便点击一个条目，再按\menu{Ctr+A}，全选所有文献条目，
	\item 右击，选择\menu{Attachment Manager-Rename and Move Attachment}，如\autoref{fig:ch3zotRename}所示。
	%zotFile_clean-att
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch3zotRename}
		\caption{重命名附件}
		\label{fig:ch3zotRename}
	\end{figure}
	
	\item 这样所有的附件都会转移到新的目录，将原来的文件夹删除即可。如果还是喜欢原来的目录，再重复操作一遍，建立原来的文件夹，再用\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}
	移动重命名即可。	
	\item 如果没有问题了，重新开启同步即可，同步设置见\cref{sec:syn}。	
\end{enumerate}

\section{如何只导出多篇文献PDF？}\label{sec:zotFile_exp_pdf}

QQ群有群友问如何导出多篇文献的PDF以方便和其他人共享，
因为默认的Zotero 导出格式中其附件会导出到单个的文件夹中，
尽管可以用Everything等软件搜索.PDF将这些附件复制或移动出来，但是毕竟不太方便。

在Zotero 7.0中有导出PDF菜单，导出的方法是，选中需要导出PDF的条目，依次点击，
\menu{File-Export PDFs...}(如果选中的是一篇文献，则显示的菜单是\menu{Export PDF...})，
然后在弹出的对话框中选择保存的目录即可。

也可以安装\href{https://github.com/redleafnew/delitemwithatt}{Delitem插件}（下载地址：
\url{https://github.com/redleafnew/delitemwithatt}，插件安装方法
见\cref{sec:installPlug}），安装后，选中需要导出附件（PDF）的条目，
右击选择\menu{Export Attachment(s)}，如\autoref{fig:ch3expAtt}所示，然后在弹出的对话框中选择保存的目录即可。

	%导出附件
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.6]{ch3expAtt}
		\caption{安装\href{https://github.com/redleafnew/delitemwithatt}{Delitem插件}后导出所选条目的附件}
		\label{fig:ch3expAtt}
	\end{figure}


也可以利用\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}移动附件的功能将条目的附件移动到某个文件夹，
曲线实现导出多篇文献的附件（PDF）功能，见\cref{sec:zotFile_clean_att}。

\section{如何查看Zotero自带的存贮剩余情况呢？}\label{sec:Zotero_stor_limit}

有群友问到怎么看zotero自带的内存剩余情况呢，在Zotero软件中没有找到已用空间的情况，
但在\href{https://www.zotero.org/settings/storage?ref=usb}{Zotero网站} 上可以看到。

输入网址：\url{https://www.zotero.org/settings/storage?ref=usb}，
在弹出的界面上填入自己的Zotero账号信息，点击\menu{login to Zotero},
如\autoref{fig:ch5zoteroUserLogIn}所示。登录后页面就会显示当前已经用的空间情况，
包括总空间和已经使用的空间大小，如\autoref{fig:ch5zoteroUserQutota}所示。

	%登录界面
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.7]{ch5zoteroUserLogIn}
		\caption{Zotero用户登录}
		\label{fig:ch5zoteroUserLogIn}
	\end{figure}
	%剩余空间
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.7]{ch5zoteroUserQutota}
		\caption{Zotero用户空间使用情况}
		\label{fig:ch5zoteroUserQutota}
	\end{figure}

\section{清空Zotero自带的免费300M空间的方法}\label{sec:Purge_space}

Zotero提供免费的300M空间可以用以存放全文附件，如果确定里面的文件不需要了，想清空这300M的空间可以通过下面的方法。方法来源于：\href{https://link.zhihu.com/?target=https%3A//forums.zotero.org/discussion/102110/how-to-remove-all-full-text-and-attachments-in-the-web-library}{How to remove all full-text and attachments in the Web library?} 
\begin{enumerate}
	\item 禁用文件同步，否则清空后这300M空间又会逐渐填满，如\autoref{fig:ch3noFileSync}所示,Sync attachment files in My ...和Sync attachment files in group...两个选项\textbf{不要选中}。
	\item 输入网址：\url{https://www.zotero.org/settings/storage?ref=usb}，
	在弹出的界面上填入自己的Zotero账号信息，点击\menu{login to Zotero}，然后再点击 下面红色的Purge Storage in My Library,如\autoref{fig:ch3purgeStorage}所示，在弹出的对话框中点击确定，然后就会发现已经占用的空间就是0M了。
	%禁用文件同步
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.6]{ch3noFileSync}
		\caption{禁用文件同步}
		\label{fig:ch3noFileSync}
	\end{figure}
	
		%清空空间
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.6]{ch3purgeStorage}
		\caption{清空Zotero存贮空间}
		\label{fig:ch3purgeStorage}
	\end{figure}
	具体过程也可见\href{https://zhuanlan.zhihu.com/p/596614249}{如何清空Zotero自带的免费300M空间}。
\end{enumerate}
	
\chapter[Zotero群组的使用]{Zotero群组的使用\footnote{如果没有使用群组的需要，本章可以略过}}\label{ch:group}
同事之间，同一个课题组之间共享题录信息可以通过Zotero提供的群组功能实现。
我们可以创建群组并邀请其他人加入(\cref{sec:CreatGroup})。
也可以作为成员申请加入其他的群组(\cref{sec:joinGroup})。
将自己的文献复制到群组，也可以将群组文献复制到我们自己的库中(\cref{sec:copyGroupLibrary})。

\section{创建群组并邀请其他人加入}\label{sec:CreatGroup}
\begin{enumerate}
	\item    将\cref{sec:zotReg}申请的
	用户信息填写到\url{https://www.zotero.org/user/login/}中，
	然后点击\menu{Login to Zotero}，
	如\autoref{fig:ch4ZotLogin}所示\label{page:zoteroLogin}。
	%zotero login
	\begin{figure}[htbp]
		\centering\
		\begin{minipage}[t]{0.6\linewidth}
			\centering
			\includegraphics[width=0.6\linewidth]{ch4ZotLogin}
			\caption{登录Zotero网站}
			\label{fig:ch4ZotLogin}
		\end{minipage}
		%zotero group
		\centering\
		\begin{minipage}[t]{0.3\linewidth}
			\centering
			\includegraphics[width=1\linewidth]{ch4ZotGroupCreat1}
			\caption{创建群组}
			\label{fig:ch4ZotGroupCreat1}
		\end{minipage}
	\end{figure}
	
	\item 在打开的网页中，依次\menu{Groups-Creat a New Group},如\autoref{fig:ch4ZotGroupCreat1}所示,
	如果申请的用户名(邮箱)没有进行激活验证，则无法创建群组，激活验证的方法见\cref{sec:zotReg}。
	
	\item 在接下来打开的页面中，输入群组的名称，当群组名称下面提示的颜色变化绿色时，这个名称才可以使用。
	然后选择群组的类型：公共开放成员型(任何人可以查看和立即加入)、公共关闭会员型(任何人可以查看但用户必须申请或邀请)
	以及私秘成员型(仅成员可以查看群组，成员必须申请或被邀请)，一般我们选择第二种或第三种，
	然后点击\menu{Creat Group}，如\autoref{fig:ch4ZotGroupName}所示。
	%zotero group
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.6]{ch4ZotGroupName}
		\caption{输入群组的名称且选择群组的类型}
		\label{fig:ch4ZotGroupName}
	\end{figure}
	\item 接下来的页面中是群组的一些设置，如群组的类型，哪些人可以读群组文献库，哪些人可以对群组编辑
	，哪些人可以编辑群组文件等，根据需要进行选择即可，完成后点击\menu{Save Settings}，
	如\autoref{fig:ch4ZotGroupSetting}所示，而后网页提示Group Settings Saved(群组设置已保存)。
	%zotero group
	\begin{figure}[htbp]
		\centering
		\includegraphics[width=0.3\linewidth]{ch4ZotGroupSetting}
		\caption{群组信息设置}
		\label{fig:ch4ZotGroupSetting}
	\end{figure}
	\item 群组设置完成后，点击页面顶部的\menu{Groups}，
	在打开的页面中点击\menu{Manage Members}链接来管理群组成员，
	如\autoref{fig:ch4ZotGroupInvite1}所示。
	在这也可以点击\menu{Manage Profile}
	或\menu{Manage Library}对群组的相关设置进行调整。
	%zotero group
	\begin{figure}[htbp]
		\centering
		\begin{minipage}[t]{\dimexpr.5\textwidth-1em}
			\centering
			\includegraphics[scale=0.7]{ch4ZotGroupInvite1}
			\caption{群组成员设置}
			\label{fig:ch4ZotGroupInvite1}
		\end{minipage}
		\begin{minipage}[t]{\dimexpr.5\textwidth-1em}
			\centering
			\includegraphics[scale=.6]{ch4ZotGroupInvite2}
			\caption{邀请群组成员}
			\label{fig:ch4ZotGroupInvite2}	
		\end{minipage}	 
	\end{figure}
	\item 在打开的页面中，点击\menu{Send More Invitations}来发送邀请，
	如\autoref{fig:ch4ZotGroupInvite2}所示,
	在打开的页面的输入框中输入被邀请人的用户名或Email地址，多个用户之间用英文逗号间隔，
	然后再点击\menu{Invite Members}，如\autoref{fig:ch4ZotGroupInvite3}所示，
	而后会返回邀请的结果，\autoref{fig:ch4ZotGroupInvite4}。
	%Group Invite Member2
	\begin{figure}[t]
		\begin{minipage}[b]{\dimexpr.5\textwidth-1em}
			\centering
			\includegraphics[scale=1]{ch4ZotGroupInvite3}
			\caption{发送邀请}
			\label{fig:ch4ZotGroupInvite3}
		\end{minipage}
		\begin{minipage}[b]{\dimexpr.5\textwidth-1em}
			\centering
			\includegraphics[scale=1]{ch4ZotGroupInvite4}
			\caption{邀请的结果}
			\label{fig:ch4ZotGroupInvite4}
		\end{minipage}
	\end{figure}
	\item 当被邀请用户按\cpageref{page:zoteroLogin}方法登录Zotero网站，
	并点击\menu{Group}后在页面右侧会显示收到的群组邀请信息，点击\menu{Join}，
	即可加入群组，如\autoref{fig:ch4ZotGroupInvite5}所示，
	然后刷新网页后就会显示当前已经加入的群组，如\autoref{fig:ch4ZotGroupInvite6}所示。
	%Group Invite Member2
	\begin{figure}[t]
		\begin{minipage}[b]{\dimexpr.5\textwidth-1em}
			\centering
			\includegraphics[scale=.8]{ch4ZotGroupInvite5}
			\caption{\menu{Join}加入群组}
			\label{fig:ch4ZotGroupInvite5}
		\end{minipage}
		\begin{minipage}[b]{\dimexpr.5\textwidth-1em}
			\centering
			\includegraphics[scale=.8]{ch4ZotGroupInvite6}
			\caption{刷新网页显示已经加入到群组}
			\label{fig:ch4ZotGroupInvite6}
		\end{minipage}
	\end{figure}
	\item 按\cref{sec:syn}的描述，用自己的用户名密码在Zotero登录后，
	在Zotero左侧面板会也会显示已经加入的群组，如\autoref{fig:ch4ZotGroupInvite7}所示,
	而且会自动将群组中的文献同步到本地。
	%Joined zotero group 
	\begin{figure}[t]
		\begin{minipage}[b]{\dimexpr.5\textwidth-1em}
			\centering
			\includegraphics[scale=.35]{ch4ZotGroupInvite7}
			\caption{登录Zotero后也可以显示已经加入的群组}
			\label{fig:ch4ZotGroupInvite7}
		\end{minipage}
		\begin{minipage}[b]{\dimexpr.5\textwidth-1em}
			\centering
			\includegraphics[scale=.8]{ch4ZotSearchGroup1}
			\caption{搜索群组}
			\label{fig:ch4ZotSearchGroup1}
		\end{minipage}
	\end{figure}
	
\end{enumerate}

\section{申请加入群组}\label{sec:joinGroup}
\begin{enumerate}
	\item 按\cpageref{page:zoteroLogin}所示方法，
	用自己的用户名/Email地址和密码登录\url{https://www.zotero.org/user/login/}网站。
	\item 登录网站后依次\menu{Groups-Search for Groups}，如\autoref{fig:ch4ZotSearchGroup1}所示。
	\item 在打开的网页中点击\menu{Groups}，
	然后输入群组的名称，点击\menu{Search Groups}，如\autoref{fig:ch4ZotSearchGroup2}所示。
	
	
	%Join zotero group 
	\begin{figure}[t]
		\begin{minipage}[b]{\dimexpr.3\textwidth-1em}
			\centering
			\includegraphics[scale=.5]{ch4ZotSearchGroup2}
			\caption{输入搜索的群组名称}
			\label{fig:ch4ZotSearchGroup2}
		\end{minipage}
		\begin{minipage}[b]{\dimexpr.3\textwidth-1em}
			\centering
			\includegraphics[scale=0.5]{ch4ZotSearchGroup3}
			\caption{群组搜索结果}
			\label{fig:ch4ZotSearchGroup3}
		\end{minipage}
		\begin{minipage}[b]{\dimexpr.4\textwidth-1em}
			\centering
			\includegraphics[scale=0.5]{ch4ZotSearchGroup4}
			\caption{点击Join申请加入群组}
			\label{fig:ch4ZotSearchGroup4}
		\end{minipage}
		
	\end{figure}
	\item 在搜索结果中点击需要申请加入的群组名称，如\autoref{fig:ch4ZotSearchGroup3}所示，
	然后在打开页面的右侧点击\menu{Join}申请加入群组，如\autoref{fig:ch4ZotSearchGroup4},
	然后网页会提示：You have applied to join this group. A group admin must approve your application.
	%zotero group
	\begin{figure}[htbp]
		\centering 
		\begin{minipage}[t]{0.6\linewidth}
			\centering
			\includegraphics[scale=0.8]{ch4ZotSearchGroup5}
			\caption{管理员批准加入群组申请}
			\label{fig:ch4ZotSearchGroup5}
		\end{minipage}
		%
		\begin{minipage}[t]{0.3\linewidth}
			\centering
			\includegraphics[scale=.3]{ch4ZotGroupNewColl}
			\caption{在群组中新建分类的结果}
			\label{fig:ch4ZotGroupNewColl}
		\end{minipage}
	\end{figure}
	
	\item 管理员的邮箱中会收到Zotero发送的邮件，
	提示有人申请加入群组，此邮件也有可能被邮箱系统放入到垃圾邮件中。
	群组管理员根据邮件提示登录到Zotero网站，
	\menu{Approve}即可，如\autoref{fig:ch4ZotSearchGroup5}所示。
\end{enumerate}


\section{群组文献添加和复制}\label{sec:copyGroupLibrary}
\begin{enumerate}
	\item 在群组库中，也可以像\cref{sec:newLibrary}点击\menu{File-New Collection...}
	或右击群组的名称选择\menu{New Collection...}
	建立分类及子分类以方便题录的管理，建立分类的结果如\autoref{fig:ch4ZotGroupNewColl}所示。
	\item 添加群组文献实现可以通过两种方法实现，一是直接将Zotero左侧面板自己文献库中的题录或分类拖放到群组库的相应文件夹中，
	如\autoref{fig:ch4ZotGroupDragCitation}所示。
	另外，也可以在选中群组库文件夹后，通过\cref{sec:ImportFromWeb}$\sim$\cref{sec:ManualImport}的方法在线导入或手动输入题录。
	%drag citataion
	\begin{figure}[htbp]
		\centering 
		\begin{minipage}[t]{0.4\linewidth}
			\centering
			\includegraphics[scale=0.5]{ch4ZotGroupDragCitation}
			\caption{拖放向群组库中添加文献}
			\label{fig:ch4ZotGroupDragCitation}
		\end{minipage}
		%
		\begin{minipage}[t]{0.4\linewidth}
			\centering
			\includegraphics[scale=.5]{ch4ZotGroupDrayFromGroup}
			\caption{拖放群组库文献到本地}
			\label{fig:ch4ZotGroupDrayFromGroup}
		\end{minipage}
	\end{figure}
	
	
	\item 看到群组库中有我们感兴趣的文献后，我们可以将文献复制到自己文件夹中，
	复制的方式是在群组库选中需要的文献或分类，拖放到本地库的相应文件夹中即可，
	如\autoref{fig:ch4ZotGroupDrayFromGroup}所示。
\end{enumerate}

\chapter{高级应用及疑难解答}\label{ch:questions}
\setcounter{footnote}{0} %重置脚注计数器
本章讲述了一些高级问题讨论和疑难解答，包括如何更改Zotero界面语言(\cref{sec:chang_gui_lan})；
如何备份和恢复Zotero数据(\cref{sec:back})；
Zotero 标签的使用(\cref{sec:tag})；在CNKI在导入题录的同时也下载全文(\cref{sec:cnki_fulltext})；
在撰写中文文章时，参考文献列表中中文作者后面为“等”，英文为“et al”(\cref{sec:etal_set})；
如何批量修改文献语言(\cref{sec:change_lan})；
文献题目中的格式(斜体、上标、下标、大小写，\cref{sec:italic}，\cref{sec:case})等问题。

\section{如何更改Zotero界面语言} \label{sec:chang_gui_lan}
安装完成后启动时，Zotero会根据操作系统的语言选择软件界面的语言，
如果你现在用的是中文版操作系统，Zotero显示的菜单就是中文的，
切换为其他语言的步骤是：在Zotero中依次点击：
\menu{编辑-设置-常规}，然后在对话框中点击\menu{Appearance and Language}下
的\menu{语言}后面的下拉菜单，选择需要的语言后，会提示
“Zotero必须重启才能使变更生效”，点击\menu{立即重启}后
Zotero软件会重新启动，重启后Zotero的界面就会变成刚才所选择的语言。
如果想把软件界面语言从英文改为简体中文，步骤是：在Zotero中依次点击：
\menu{Edit-Settings-General}，在\menu{Appearance and Language}下的
\menu{language}后面的下拉菜单，找到需要的语言后\menu{中文(简体)}，会提示
“Zotero must be restarted for the change to take effect”，
点击\menu{Restart now}后
Zotero软件会重新启动，重启后Zotero的界面就会变成简体中文，	如\autoref{fig:ch5Chang_gui_lan}所示。

%更改界面语言
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.5]{ch5Chang_gui_lan}
	\caption{更改界面语言}
	\label{fig:ch5Chang_gui_lan}
\end{figure}

\section{如何备份和恢复Zotero数据} \label{sec:back}
Zotero的备份包括其设置（或称为配置，包括插件及其设置、文件的存贮路径）和
数据（主要包括其文献条目、附件、style、translator等）。不要指望通过同步
来备份，同步只是同步了参考文献条目和存放在storage目录中的附件，而Zotero
的设置、存为链接的附件、style、translator不会被同步。

\subsection{Zotero设置的备份与恢复}
不同系统Zotero配置默认位置见
\href{https://www.zotero.org/support/kb/profile_directory}{Profile directory location}，
Windows 11/10/8/7/Vista中的默认位置在
\winpath{C:\Users\<User Name>\AppData\Roaming\Zotero\Zotero\Profiles\<randomstring>},
在Windows 11/10/8/7/Vista中同时按\keys{Win+R}，输入\path{\%appdata\%}，回车。就会打开\winpath{Roaming}目录，
然后再双击Zotero等文件夹进入最终的目录，如vwadz9wo.default，
备份就是将这个目录复制到一个其他的目录，如\winpath{D:\Zotero_back}。
恢复设置的过程是按\keys{Win+R}，输入，\verb|<zotero安装路径>\zotero.exe -P|，
如 \verb|D:\zotero\zotero.exe -P|回车，在弹出的对话框中点击
\menu{Creat Profile}，再点击\menu{Next}，
输入profile的名称，点击\menu{Choose Folder...}，
找到刚才备份的目录，如\winpath{D:\Zotero_back\vwadz9wo.default}，最后点\menu{Finish}。
在返回的界面中点击\menu{Start Zotero}。如果你的新电脑中目录结构与旧电脑一致，
原来的设置（包括目录设置，插件、同步的用户）都会回来。以后启动Zotero时按原来的方式即可。
备份和恢复Zotero设置的图文操作见\href{https://zhuanlan.zhihu.com/p/350546813}
{Zotero设置的备份与恢复}。

\subsection{Zotero数据的备份与恢复} \label{sec:data_dir}
不同操作系统的Zotero数据默认存放位置见\href{https://www.zotero.org/support/zotero_data}{Zotero Data Directory}，
Windows 11/10/8/7/Vista中的默认位置在
\winpath{C:\Users\<User Name>\Zotero}，具体到自己的Zotero存放位置查看方式为：在Zotero依次点击：
\menu{Edit-Settings-Advanced}，
在\menu{Data Directory Location}下面显示的路径即是
当前Zotero用户数据存放的位置，点击\menu{Show Data Directory}资源管理器会跳转到当前Zotero用户的数据目录。

数据文件夹中几个比较重要的目录和文件：\winpath{locate}为检索引擎文件存放处；
\winpath{styles}为csl文件存放处；\winpath{translator}转换器如cnki.js存放处；
\winpath{storage}为附件（PDF、网页快照等）存放目录。
用了{设置\href{https://github.com/MuiseDestiny/zotero-attanger}{Attanger}或\href{https://github.com/wileyyugioh/zotmoov}{ZotMoov}插件后附件就不再存放于此了。
zotero.sqlite是这个文件夹中最重要的文件，
包含条目元信息、笔记、标签等。Zotero启动时读取这个文件。
zotero.sqlite.bak为zotero.sqlite的备份
（关闭zotero时或此文件超过12h没更新时会更新），
zotero.sqlite.1.bak为zotero升级时zotero.sqlite的备份。

备份Zotero数据的方法就是将这个目录复制到其他安全的地方即可。
恢复Zotero数据的方式为在Zotero依次点击\menu{Edit-Settings-Advanced}，
点击Data Directory Location下面\menu{Choose}，选定自己备份的目录，根据提示重新启动Zotero即可打开以前的数据。
备份和恢复Zotero数据的图文操作见\href{https://zhuanlan.zhihu.com/p/350549136}
{Zotero数据的备份与恢复}。

除了手动进行Zotero的设置和数据进行备份外，还可以利用JavaScript脚本进行设置和数据
的备份。前期经过摸索，编写了一个自动备份配置和数据的JavaScript，请有兴趣的测试。
\begin{enumerate}
	\item 到\href{https://github.com/redleafnew/zotero-javascripts/blob/main/8back%20up%20profile%20and%20data.js}
	{https://github.com/redleafnew/zotero-javascripts/}，
	点击\menu{Raw}，复制或另存JS脚本。
	\item 在Zotero中依次点击\menu{Tools-Developer-Run JavaScript}。
	\item 将代码复制到Code窗口内。
	\item 在代码框中将\verb|var back_path = 'f:\\backup';//备份目录|，
	单引号内的内容修改为自己的目录。
	\item 点击\menu{Run}。
	\item 则配置和数据会备份到4设置目录下相应日期的\winpath{profile}和\winpath{data}文件夹中。
\end{enumerate}

利用JavaScript进行设置和数据备份的过程也可见\href{https://zhuanlan.zhihu.com/p/357859432}
{Zotero利用JavaScript备份配置和数据}，除此之外，还可以借助\href{https://github.com/l0o0/tara}{蒲公英}插件对设置和数据进行血仇和恢复，使用方法见\url{https://zotero-chinese.com/user-guide/plugins/tara}。

\section{如何新建一个Profile？} \label{sec:creatProfile}
如果Zotero发生了问题，现有设置无法打开，
甚至重新安装Zotero，再打开Zotero，仍然是以前错误的设置，
可以尝试新建一个Profile。
\begin{note}
	新建Profile原来安装的插件、数据显示消失，但数据没有真正删除，
	只是没有在新建的Profile打开，仍然在你的电脑上，
	可以切换为原来的Profile打开。
\end{note}
如果Zotero在运行，需要先关闭它。以Winows 10操作系统为例，新建Profile的步骤如下：
\begin{enumerate}
	\item 同时按键盘上的\keys{Win+R}
	（
	\href{https://product.pconline.com.cn/itbk/software/dnwt/1601/7475121.html}{Windows键是哪个电脑上的Win键在哪？} ）
	\item 在弹出的对话框中输入当前电脑上Zotero的安装位置\verb|\zotero.exe -p|，
	如\verb|d:\zotero.exe -p|。
	\item 在弹出的对话框中列出当前电脑上已有的Profile，
	点击\menu{Creat Profile} 可以尝试新建一个Profile。
	\item 在下面的向导中点击\menu{Next}。
	\item 在向导中输入新profile名称，
	默认存放位置为\winpath{C:\Users\\[你的用户名]
		\\AppData\\Roaming\\Zotero\\Zotero\\Profiles\\
		[随机字母和数字].Default User}文件夹内，
	可以点击\menu{Choose Folder}存放到其他位置，点\menu{Finish}完成创建。
	\item 返回到选择Profile对话框，可以点击新建的Profile名字，
	再点击\menu{Start Zotero}。
	\item 启动后相当于一个全新的Zotero了，可以安装插件，进行相关设置。
	\item 如果想切换回原来的profile，再重复1-3，在对话框中选择原来的Profile即可。
\end{enumerate}
可以按\cref{sec:data_dir}的方法恢复数据。上面操作步骤的图文过程见\href{https://zhuanlan.zhihu.com/p/404906012}{Zotero如何新建一个profile？}。

\section{使用添加引用的经典对话框} \label{sec:classView}				
\cref{sec:insertRef}提到在Word中插入插入参考文献时，需要搜索文章题目、作者等，如果觉得不方便，
也可以使用\menu{经典视图}，如果只是偶尔使用，可以点击插入文献时对话框中的\menu{Z}，然后在
点击\menu{经典视图}，如\autoref{fig:ch5ClassView}所示，在弹出的添加/编辑引文对话框中可以
选择插入的文献，或点击\menu{Multiple Sources...}后点击文献，再
点击$\Rightarrow$ ，如果要在同一个地方插入多条文献，也可以在此对话框
中点击$\Uparrow$ 或$\Downarrow$，对插入的文献进行排序，如果有不
需要的也可以选中文献后点击$\Leftarrow$ 将其移出，如\autoref{fig:ch5MulItem}所示，
插入完毕后点击\menu{OK}。
如果想总是使用经典视图，在Zotero依次点击\menu{Edit-Settings-Cite-Use classic Add Citation dialog}，使前面的方框内出现$\checkmark$，
如\autoref{fig:ch5UseClassic}所示。
	%经典视图
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.45]{ch5ClassView}
		\caption{偶尔使用切换到经典视图}
		\label{fig:ch5ClassView}
	\end{figure}
	%同一地方插入多条文献
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.45]{ch5MulItem}
		\caption{插入多条文献}
		\label{fig:ch5MulItem}
	\end{figure}
	%一直使用经典对话框
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.4]{ch5UseClassic}
		\caption{总是使用经典对话框}
		\label{fig:ch5UseClassic}
	\end{figure}

\section{插件Plugins无法打开的解决办法} \label{sec:plugin_no_open}
重启Zotero，或者重启电脑。

如果没有用，以安全模式启动Zotero（在启动Zotero时按住Shift）,然后尝试禁用任何第三方插件。

此时再点击工具-插件，发现安全模式下所有插件已经被禁用，然后禁用或删除可疑插件，再尝试正常启动。

或者用“以故障排除模式重启”：点击\menu{Help-Resart in Troubleshooting Mode...},如\autoref{fig:ch5TroubleShooting}在弹出的界面点击\menu{Resart Now},Zotero重启后会进入安全模式，所有插件被禁用，然后禁用或删除可疑插件，再尝试正常启动。
%一直使用经典对话框
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.6]{ch5TroubleShooting}
		\caption{以故障排除模式重启}
		\label{fig:ch5TroubleShooting}
	\end{figure}

\section{Zotero 标签的使用} \label{sec:tag}
在默认设置情况下，Zotero界面左下角的区域显示的是Zotero的标签，
我们可以使用Zotero的文件夹（创建文件夹的操作见\cref{sec:newLibrary}）和标签功能来管理文献，
一般情况下，我们按不同的专题或研究方向将文献放到不同的文件夹，这样管理起来比较方便。
既然有了文件夹为什么还需要使用标签呢？因为有时候，一篇文献可能属于多个文件夹，
例如我们可以将所有文献分为“已读”和“未读”两类；或是挂个某个项目编号的文章也可能属于多个文件夹。
当然这种情况下，也可以把文献复制到不同的文件夹或是建立子文件夹（再建立“已读”和“未读”子文件夹），
但操作起来会比较麻烦。这时候就可以使用Zotero的标签功能，实现这种文献的“交叉”管理
\footnote{除了标签之外，可以通过
	分类(文件夹)和关联对文献进行管理，详见
	\href{https://zhuanlan.zhihu.com/p/275707703}{Zotero分类、标签和关联的使用。}}。

Zotero在导入文献时，会将文献的关键词以及主题作为标签导入到文献库中（称为“自动标签”），
看起来比较杂乱，我们可以使它不显示，或是删除自动生成的这些标签。方法是点击标签管理区域的漏斗图标
，点击\menu{Show Automatic}前的方框，使之不选中如\autoref{ch5DeleteAutoTag}所示。
或是点击\menu{Delete Automatic Tags in This Library...}，
在弹出的对话框中点击\menu{OK}，
即会删除自动标签，如\autoref{ch5DeleteAutoTagOK}所示。
也可以在标签上右击，再点击\menu{Delete Tag...}，
删除单个标签。

\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.5]{ch5DeleteAutoTag}
	\caption{使自动标签不显示或删除自动标签}
	\label{ch5DeleteAutoTag}
\end{figure}
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.5]{ch5DeleteAutoTagOK}
	\caption{确认删除自动标签}
	\label{ch5DeleteAutoTagOK}
\end{figure}

使用标签功能最好把这个功能禁用，在Zotero中依次点击\menu{Edit-Settings-General}，在界面的中间位置，在
Automatically tag items with keywords and subject headings前面方框内点击，使它处于不选中状态，如\autoref{ch5DisableImportTag}所示。
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.5]{ch5DisableImportTag}
	\caption{导入文献不自动导入关键词作为标签}
	\label{ch5DisableImportTag}
\end{figure}

在Zotero中给条目添加标签的方法是，首先选中需要添加标签的文献，
点击右侧标签图标，再点击\menu{+}，
输入需要命名的标签，如\autoref{fig:ch5Add_tag}所示，输入完毕按回车，
这种方法适用于新建一个标签，一次只能为一篇文献添加标签，
但可以为一篇文献添加多个标签，只需要不断点击\menu{+}即可，
如果想删除一篇文献的标签，可以点击\menu[,]{-}号。也可以将多篇文献选中，
然后拖动到左下角标签区域的某个标签上，这样可以为多篇文章添加标签，
但前提是这个标签已经存在。
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.5]{ch5Add_tag}
	\caption{给一篇文献添加标签}
	\label{fig:ch5Add_tag}
\end{figure}

以后需要某个标签的文献时，只需要在标签区域点击这个标签，右侧文献显示区域就会显示这个标签下的所有文献，如\autoref{ch5Seclect_tag}所示。
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.5]{ch5Seclect_tag}
	\caption{点击某一标签就会显示这个标签下的文献}
	\label{ch5Seclect_tag}
\end{figure}

在Zotero的标签区域，你会发现所有的标签是按字母排列的，中文标签排在英文之后。
我们可以给标签指定颜色，指定了颜色的标签会排到前面，比较美观。
方法是右击需要设定颜色的标签，点击\menu{Assign Color}，
如\autoref{ch5Assign_color}所示，一个库中可以给9个标签指定颜色，
在这个界面也可以给标签重命名或删除标签。
\begin{figure}[htbp]
	\begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
		\centering
		\includegraphics[scale=0.6]{ch5Assign_color}
		\caption{给标签指定颜色1}
		\label{ch5Assign_color}
	\end{minipage}
	\begin{minipage}[t]{\dimexpr0.5\textwidth-4em}
		\centering
		\includegraphics[scale=0.5]{ch5SetTagColor}
		\caption{给标签指定颜色2}
		\label{ch5SetTagColor}
	\end{minipage}
\end{figure}	


在弹出的对话框中给标签指定喜欢的颜色和标签位置，
\menu{Set Color}，如\autoref{ch5SetTagColor}所示。

如果设置的标签过多，找不到需要的标签，
可以在标签区域的最下方输入标签的名称进行搜索，
上方会显示搜索得到的结果，如\autoref{ch5SearchTag}所示。
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.6]{ch5SearchTag}
	\caption{搜索标签}
	\label{ch5SearchTag}
\end{figure}

\section{如何批量删除标签}\label{sec:batch_delete_tag}
对多篇文章加同一标签（tag）的方法是选中这些文章，然后拖动到标签上.有网友问数十篇文献同时去除同一个标签要怎么操作呢？除了一个一个点去除，有其他快捷去除的方式吗？

其实很简章，先按住Shift或Ctrl将处理的文章选中，然后再按住Shift同时，将选中的文章拖到需要删除的标签上即可。

见\href{https://zhuanlan.zhihu.com/p/500361660}{数十篇文献同时去除同一个标签要怎么操作呢？除了一个一个点去除，有其他快捷去除的方式吗？}

\section{更新CNKI.js，当有权限时在CNKI导入题录的同时下载全文}\label{sec:cnki_fulltext}

一直以来，我们只能在CNKI在导入题录，而全文CAJ或PDF文件都不能同时下载下来。
近期，有国内的网友\href{https://www.zhihu.com/people/lin-zhi-70}{林知}
对CNKI的translator\footnote{translator相当于一个转换器，
	将网页上的元素翻译为在Zotero导入网页信息时可以识别的Zotero条目。
	如果你想学习translator编写请参阅
	\href{https://www.zhihu.com/people/lin-zhi-70}{林知}写的
	\href{https://zhuanlan.zhihu.com/p/349871853}{Zotero Translator 开发文档}。}
进行了修改，
\href{https://www.linxingzhong.top/posts/2019-11-5/?tdsourcetag=s_pctim_aiomsg}{参见网址}。
如果你当前在导入CNKI题录时不能同时下载全文，请参考下面的步骤：
\begin{enumerate}
	\item\label{it:cnkijs}
	先到\href{https://github.com/Zotero-CN/translators_CN}{ Zotero translators 
		中文维护小组的GitHub\footnote{在这个GitHub上除了CNKI的translator之外，
			还有其他几个国内经常使用的数据库，如万方数据、维普、百度学术、谷粉学术、
			专利搜索网站SooPAT。如果Zotero自带translator使用异常，可以选择使用这个网站上的。} 
		\url{ https://github.com/Zotero-CN/translators_CN}}下载CNKI.js
	，用浏览器\footnote{IE浏览器可能打不开，请使用Chromium内核
		浏览器，如\href{https://www.microsoft.com/zh-cn/edge}{新版Microft EDGE}、
		\href{http://www.centbrowser.cn/history.html}{百分浏览器}等打开。}打开
	\url{https://raw.githubusercontent.com/l0o0/translators_CN/master/CNKI.js},
	在打开的网页中右击，选择\menu{另存为(A)...}，如\autoref{fig:ch5CNKIJS}图示：
	%CNKI.js
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.8]{ch5CNKIJS}
		\caption{CNKI.js下载}
		\label{fig:ch5CNKIJS}
	\end{figure}
	\item
	将上一步下载的CNKI.js复制到Zotero的translator目录中(如\winpath{E:\hmy\zotero\translator})。
	或在上一步直接将CNKI.js下载到这个目录中。覆盖原来的CNKI.js，保险起见，
	可以先将原来的CNKI.js复制到其他地方备份，如果有问题再复制回来。
	如果忘了自己的translator目录，可以在Zotero中依次点击
	\menu{Edit-Settings-Advanced}
	中查看，如\autoref{fig:ch5translatorDir}所示：
	%translator dir
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.6]{ch5translatorDir}
		\caption{查看translator目录所在的文件夹}
		\label{fig:ch5translatorDir}
	\end{figure}
	\item
	在浏览器的Zotero插件上右击，依次点击\menu{选项或扩展选项-Advanced} Translator下面的Reset Translators,
	见\autoref{fig:ch5ZoteroOption}，\autoref{fig:ch5ZoteroUpdateTran}：
	%Zotero选项
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.8]{ch5ZoteroOptions}
		\caption{右击Zotero在浏览器中的图标}
		\label{fig:ch5ZoteroOption}
	\end{figure}
	%更新translator
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.6]{ch5ZoteroUpdateTran}
		\caption{更新translator}
		\label{fig:ch5ZoteroUpdateTran}
	\end{figure}
	\item
	登录\href{http://www.cnki.net}{CNKI}，试一下在有权限情况时下载题录的同时是否把全文pdf也下载了,
	具体方法参见\cref{sec:cnki}。如果不行，试着重新启动浏览器和Zotero，或是重启一下系统。
\end{enumerate}

除了到\href{https://github.com/Zotero-CN/translators_CN}{ Zotero translators 
	中文维护小组的GitHub 
	\url{ https://github.com/Zotero-CN/translators_CN}}下载js外，也可安装
\href{https://github.com/l0o0/jasminum/releases}{茉莉花插件}，安装方法见
\cref{sec:installPlug}, 这个插件除了\cref{sec:Chinese_PDF}所述的抓取中文PDF元信息
之外，也可以更新非官方的一些中文网站的js，具体步骤为：在Zotero中依次点击\menu{Edit-Settings-
	Jasminum} Chinese Translators下的\menu{Refresh}，稍等一会，上面会显示
一些中文网站translator，绿色对勾的表示当前是最新的，
绿色的$\Downarrow$表示没有安装的还需要更新的，点击绿色的$\Downarrow$更新或安装。
或点击\menu{Update All}更新所有中文translator。当然，在此处更新完毕后也需
要在浏览器Zotero Connector中更新translator信息。安装茉莉花插件和用其更新translator信息
的步骤也可见\href{https://zhuanlan.zhihu.com/p/347628976}
{[Zotero]插件（扩展）的安装--以茉莉花（jasminum）为例
	\url{https://zhuanlan.zhihu.com/p/347628976}}和
\href{https://zhuanlan.zhihu.com/p/347642670}
{[Zotero]利用jasminum（茉莉花）安装或更新部分中文网站translator
	\url{https://zhuanlan.zhihu.com/p/347642670}}。


上面的操作步骤也可参见知乎专栏文章\href{https://zhuanlan.zhihu.com/p/90638718}{[Zotero]
	有权限时在导入CNKI题录时同时下载全文的方法\url{https://zhuanlan.zhihu.com/p/90638718}}。

\section{自定义的style或translator总是被恢复为官方的怎么办？}\label{sec:reset_style}
如果你发现使用自己修改的或别人发给你的style（样式）或translator（转换器）文件过段时间后
就又恢复为原来官方仓库中的文件了，可能是你用的csl或js文件的id和官方的相同，
默认情况下Zotero会自动更新样式（至少每24小时会自动更新）和转换器文件（隔几天会自动更新），
根据产生的原因，可以通过修改样式和转换器id或禁用Zotero自动检查和更新转换器和样式的方法解决。

\begin{enumerate}
	\item 方法1修改id：
	
	打开数据文件夹下(数据文件夹在\cref{sec:data_dir}提到)的csl或js文件，
	在<info>和</info>字段之间找到这个style文件的id，
	如：http://www.zotero.org/styles/chinese-law-journals
	将这个id改为非官方id，如添加信息：			
	http://www.zotero.org/styles/chinese-law-journals-custom
	，这个网址不存在也没有问题，保存style文件即可。如果需要修改的是js文件的id，
	则直接修改js文件中的translatorID后面的值即可。
	后面就不会覆盖这个文件了
	（除非你的这个id与Zotero官方仓库中另一个style或translator文件的id相同）。
	\item 方法2禁用自动更新translators和styles的功能：
	
	在Zotero中依次点击：\menu{Edit-Settings-Advanced-		
	Automatically check for updated translators and styles}将前面的$\checkmark$去掉，
	如\autoref{fig:ch5reset_style}所示：
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5reset_style}
		\caption{禁用自动更新转换器和样式}
		\label{fig:ch5reset_style}
	\end{figure}
\end{enumerate}

\section{不能自动更新引文了是怎么回事}\label{sec:norefresh}
@我叫小可爱网友询问：zotero 现在不能自动更新引文上标了如何解决，
必须要点击Refresh才可以。

解决方法：

在Word的Zotero工具条中点击\menu{Document Preferences}，
确认\menu{Appearance}
下的\menu{Automatically update citations}前面的方框中有没有$\checkmark$，
如果没有，点击一下，使之选中，然后再插入文档应该就会自动更新了,
如\autoref{fig:ch5NoFresh}所示。
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.5]{ch5NoFresh}
	\caption{自动更新引文}
	\label{fig:ch5NoFresh}
\end{figure}

\section{引文下面有虚线下划线是怎么回事？}\label{sec:citationUnderline}
在使用年代作者的引文格式插入到Word中，有时会发现引文下面有虚线下划线，如
\autoref{fig:ch5underline}所示。
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.5]{ch5underline}
	\caption{引文有下划线}
	\label{fig:ch5underline}
\end{figure}

这是怎么回事呢？

原因可能是在插入引文选择使用的样式的界面，没有勾选Automatically update citations这个选项，
或是编辑长文档时为了加快Word的反应速度
（如果Word中已经插入了很多文献，再新加文献时，Word会扫描已经插入的文献，
更新已经插入的文献格式，从而可能会反应比较长的时间）有意禁用了自动更新引文功能。
加虚线下划线的原因是为了提醒作者，这些引文可能没有更新到最新格式。

知道了原因，就很容易解决了，打开自动更新选项，点一下刷新按钮即可，如\autoref{fig:ch5refresh}所示。
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.5]{ch5refresh}
	\caption{点击自动更新引文后刷新}
	\label{fig:ch5refresh}
\end{figure}。


如果刷新后还是有下划线，把带下划线的引文删除再重新插入一下试试。		
效果如\autoref{fig:ch5noUnderline}所示。
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.5]{ch5noUnderline}
	\caption{自动更新引文}
	\label{fig:ch5noUnderline}
\end{figure}


参考：\href{https://www.zotero.org/support/kb/citations_underlined}{Why are my citations underlined with a dashed line?}

\section{如何设置Zotero生成的参考文献格式，刷新后不变？}\label{sec:refresh}
Endnote在Word的工具栏中可以设置文末参考文献列表的格式，而Zotero中没有这些功能，
如果只是单纯设置格式，那么再插入其他或修改参考文献后格式就会恢复到默认的字体格式，
但可以通过在Word中的“书目”样式来实现，而且刷新后也可以保持不变。
参考 网友@滏阳河边捉蚯蚓 的方法，具体步骤如下：
\begin{enumerate}
	\item
	用Zotero在Word中生成参考文献后(参见\cref{sec:insertRef})，
	将光标定位到参考文献中，或选中生成的参考文献，点击样式处右下角的箭头，
	然后向下拉找到\menu{书目}，再点击\menu{书目}后面的向下的箭头，
	点击\menu{修改},如\autoref{fig:ch5Biblio}所示：
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5Biblio}
		\caption{找到书目样式}
		\label{fig:ch5Biblio}
	\end{figure}
	\item
	根据期刊或毕业论文排版要求设置格式，如可以将英文字体设置为Times New Roman，
	字号：五号，点击\menu{格式-段落}在弹出的对话框中设置缩进，行间距等，如
	可以设置行间距为20磅，如\autoref{fig:ch5Format}，\autoref{fig:ch5Hanging}所示。
	%样式修改
	\begin{figure}[t]
		\centering
		\includegraphics[scale=0.5]{ch5Format}
		\caption{对样式进行修改}
		\label{fig:ch5Format}
	\end{figure}
	
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5Hanging}
		\caption{设置悬挂缩进}
		\label{fig:ch5Hanging}
	\end{figure}
	\item
	如果都确定后，发现文末参考文献格式没有变化，那么选中所有参考文献，
	再点击\menu{样式}中的\menu{书目}，
	如\autoref{fig:ch5FreshFinalformat}所示。
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.8]{ch5FreshFinalformat}
		\caption{全选后再次点击\menu{书目}}
		\label{fig:ch5FreshFinalformat}
	\end{figure}
	\item
	如果再插入文献或刷新后，会发现格式仍然是我们刚才设置的格式。
	%\url{https://zhuanlan.zhihu.com/p/58969571}
\end{enumerate}

\section{中文作者后为“等”，英文为“et al”的设置方法}\label{sec:etal_set}	
一直以来在Word中同时引用中英文文献，
使用默认的Chinese-gb7714-1987-numeric格式化文献，
在作者超过三个后同时显示“et al”和“等”是写作的难题（latex可以轻松解决），
形如：
\begin{lstlisting}[language=HTML]
	[20]	李亚丽, 刘晓徐, 郑培华,  等 . 美拉德反应研究进展[J]. 食品科技, 2012, 37(09): 82–87.
	[21]	Park S y., Kim Y j., Lee H c.,  et al. Effects of Pork Meat Cut and Packaging Type on Lipid Oxidation and Oxidative Products during Refrigerated Storage (8 °C)[J]. Journal of Food Science, 2008, 73(3): C127–C134.
	[22]	郭淑珍, 哈益明, 刘书亮,  等. 影响熟肉制品辐照所致脂肪氧化因素分析[J]. 食品科技, 2006(09): 130–133.
\end{lstlisting}
解决方法或者是手动修改，或是编写宏批量替换，
使中文的参考文献中超过3个作者显示为“等”，英文的为“et al”，。
无论哪种方式在刷新文档，插入删除文献后会恢复为不正常的情况，
或是都显示为“等”，或显示为“et al”。


中英文混排（即et al和等正确显示）需要在csl文件中有两个layout（见\href{https://gitee.com/zotero-chinese/zotero-chinese/issues/I4XKKJ}{CSL文件中两个LAYOUT的含义}），分别控制中文和英文条目的显示方式，而具体显示et al还是等，则是通过不同语言的locale（\url{https://github.com/citation-style-language/locales/}）文件控制的。中英文混排实现具体步骤为：
\begin{enumerate}
	\item 到\href{https://zotero-chinese.com/styles/}{中文 CSL 样式}下载合适的csl(这上面的csl大部分都支持双语混排显示)。
	\item 本地安装下载的style，方法见\cref{sec:addStyle}。:

	\item 在插入或格式化参考文献格式时，选择
	下载的这个style，见\cref{sec:changeStyle}。
	 
	\item 正常情况下，中文参考文献三个作者后面应该为“等”，英文为“et al”，
	如果不正常，在Zotero库中将英文文献的“Language”字段修改为“en”
	\footnote{我遇到的不正常的情况是英文作者后面也是“等”，如果中文作者后面
		成了“et al”，可以尝试修改中文文献的“Language”字段修改为“cn”或“中文”试试。}，
	如\autoref{fig:ch5JmLanguage}所示：
	%将英文文献的“Language”字段修改为“en”
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.7]{ch5JmLanguage}
		\caption{将英文文献的“Language”字段修改为“en”}
		\label{fig:ch5JmLanguage}
	\end{figure}
	\item 修改完毕后，返回Word，点击Zotero工具条中\menu{Refresh}按钮，最终结果
	如\autoref{fig:ch5Jm-final}所示：
	%点击Refresh后最终结果
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.6]{ch5Jm-final}
		\caption{\menu{Refresh}后最终结果}
		\label{fig:ch5Jm-final}
	\end{figure}
\end{enumerate}

也可参考\href{https://gitee.com/zotero-chinese/zotero-chinese/issues/I4YKIN}{利用合适的CSL，结合设置条目语言解决et al和等混排问题}。

\section{批量修改文献语言字段}\label{sec:change_lan}	

使用支持中英混排双语同时显示“等”和“et al”的csl
（见\cref{sec:etal_set}及\href{https://gitee.com/zotero-chinese/zotero-chinese/issues/I4YKIN}{利用合适的CSL，结合设置条目语言解决et al和等混排问题}或
\href{https://zhuanlan.zhihu.com/p/314928204}
{Zotero修改版终于可以原生支持同时生成“et al”和“等”了}
）时需要修改语言，一般可以在Zotero点击选中条目（文献）
后再点击Info下面的\menu{language}字段直接修改为en。
如果有多篇需要修改，这样操作就显得比较烦琐了。
下面提供两个批量修改的方法：
\begin{enumerate}
	\item 使用JavaScript语言
	\begin{enumerate}[(1)]
		\item 在Zotero选中需要修改语言的条目；
		\item 复制下面的代码到剪切板：
		%JavaScript
		\begin{lstlisting}[language=JavaScript]
			var zoteroPane = Zotero.getActiveZoteroPane();
			var items = zoteroPane.getSelectedItems();
			var pattern = new RegExp("[\u4E00-\u9FA5]+");
			for (let item of items) {
				var title = String(item.getField("title"));
				if (Zotero.ItemTypes.getName(item.itemTypeID) == 'computerProgram' // 文献类型为软件时返回
				) {
					continue;
				}
				var lan = pattern.test(title) ? 'zh-CN' : 'en-US';
				try {
					if (item && !item.isNote() && item.isRegularItem() &&
					Zotero.ItemTypes.getName(item.itemTypeID) != 'computerProgram') { //正常条目，非笔记设置语言
						item.setField("language", lan);
						await item.saveTx();
					}
					
				} catch (error) {
					Zotero.debug(`语言设置失败，可能条目类型${Zotero.ItemTypes.getName(item.itemTypeID)}不能设置语言。`)
				}
				
			}
			if (items.every((item) => // 如果都是软件提示错误
			Zotero.ItemTypes.getName(item.itemTypeID) == 'computerProgram')) {
				return false;
			} else {
				return '语言自动设置完毕。'; // 语言设置成功提示;
			}
		\end{lstlisting}
		\item 点击\menu{Tools-Developer-Run JavaScript}，如：
		如\autoref{fig:ch5RunJavaScript0}所示。
		
		%run javascript
		\begin{figure}[htbp]
			\centering
			\includegraphics[scale=0.7]{ch5RunJavaScript}
			\caption{运行JavaScript}
			\label{fig:ch5RunJavaScript0}
		\end{figure}
		%批量修改语言结果
		\begin{figure}[htbp]
			\centering
			\includegraphics[scale=0.5]{ch5Chang_lan}
			\caption{批量修改语言结果}
			\label{fig:ch5Chang_lan}
		\end{figure}
		\item 在弹出的对话框中将以下代码复制进去。
	
		\item 将JavaScript代码粘贴到代码框中，
		点击\menu{Run}。会根据条目语言，将language字段设置为en-US或zh-CN，
		如\autoref{fig:ch5Chang_lan}所示。
	\end{enumerate}
\end{enumerate}
也可以使用\href{https://github.com/redleafnew/delitemwithatt}{Del Item With Attachment}、\href{https://github.com/northword/zotero-format-metadata}{Linter for Zotero}插件或\href{https://getquicker.net/Sharedaction?code=e16164f9-2759-4054-d88b-08db94dc6a8e}{自动设置语言}\href{https://getquicker.net/}{Quicker}动作实现对language的字段的自动填充。

\section{参考文献作者缩写后面的点如何删除}\label{sec:authorPoint}
一些国外期刊（如Nature）要求参考文献列表中作者的名字需要缩写，
而且要以点（.）结尾，但很多国内期刊要求名字缩写后面不需要点，
如何删除名字缩写后面的点呢？下面以nature.csl为例，看一下如何修改。
\begin{enumerate}
	\item 用任意文本编辑器打开自己数据文件夹(数据文件夹在\cref{sec:data_dir}提到)
	下的nature.csl文件。
	\item 搜索initialize-with=". "，将引号内的点删除，
	变为initialize-with=" "，保存文件，在Word使用这个样式文件即可\footnote{如果修改后使用这个style仍然带点，按\cref{sec:addStyle}的方法，重新添加这个style试试。}。
	\item 如果过段时间，这个csl恢复为带点的格式，参考\cref{sec:reset_style}解决。
\end{enumerate}

\section{使作者列表中某些作者加粗，加星而且刷新后不变}\label{sec:authorBold}

在写简历或申报项目时，如果需要附上自己已经发表的论文，自己的名字往往需要加粗，
而通讯作者需要加*，NSFC并列第一作者还需要加\#，一般的做法是在生成参考文献列表
后手动将需要的名字加粗，加星，加\#，但这样做在更新文献（例如你有了新大作）
时加的这些标记会消失，需要重新加。下面提供一个稍为省事的办法：

实现的原理是通过批量替换的方式在作者的姓名前后加上加粗的标记，
如：<b>作者</b>，而通讯作者，加\#也是替换为名字后面加*或\#。
如果不需要这个功能了，则再替换为以前的就可以了。
但这样替换也存在一个问题，使用名字缩写的csl时，加的*和\#会被省略。

在Zotero选中需要修改作者的条目。然后
依次点击：\menu{Tools-Developer-Run Javascript}，
将以下代码复制到Code窗口中：

%使作者加粗
\begin{lstlisting}[language=JavaScript]
	var oldName = "Minyi Han";   //原来的姓名，名在前，姓在后
	var newFirstName = "<b>Minyi</b>"; //新的名字，加*
	var newLastName = "<b>Han</b>"; //新的姓
	
	var rn = 0; //计数替换条目个数
	await Zotero.DB.executeTransaction(async function () {
		zoteroPane = Zotero.getActiveZoteroPane();
		items = zoteroPane.getSelectedItems();
		for (item of items) {
			let creators = item.getCreators();
			let newCreators = [];
			for (let creator of creators) {
				if (`${creator.firstName} ${creator.lastName}`.trim() == oldName) {
					creator.firstName = newFirstName;
					creator.lastName = newLastName;
					creator.fieldMode = newFieldMode;
					rn+=1;
				}
				newCreators.push(creator);
				
			}
			item.setCreators(newCreators);
			
			await item.save();
			
		}
		
	}); 
	return rn + " item(s) updated";
\end{lstlisting}
点击\menu{Run}，则符合条件的作者姓名前后会加上<b>和</b>。
然后再Word中插入此条文献时，作者就会加粗，自己替换时需要修改的作者姓名。

也可以使用下面代码，不是对所选择的条目有效，需要结合标签（tag）使用，
在本例中标签（tag）的名称为“通讯作者”。
%使用作者加粗另一代码
\begin{lstlisting}[language=JavaScript]
	var oldName = "Minyi Han";
	var newFirstName = "<b>Minyi</b>";
	var newLastName = "<b>Han</b>";
	var newFieldMode = 0; // 0: two-field, 1: one-field (with empty first name)
	
	var s = new Zotero.Search();
	s.libraryID = ZoteroPane.getSelectedLibraryID();
	var tagName = '通讯作者'; //添加标签
	s.addCondition('tag', 'is', tagName);
	s.addCondition('creator', 'is', oldName);
	
	var ids = await s.search();
	if (!ids.length) {
		return "No items found";
	}
	await Zotero.DB.executeTransaction(async function () {
		for (let id of ids) {
			let item = await Zotero.Items.getAsync(id);
			let creators = item.getCreators();
			let newCreators = [];
			for (let creator of creators) {
				if (`${creator.firstName} ${creator.lastName}`.trim() == oldName) {
					creator.firstName = newFirstName;
					creator.lastName = newLastName;
					creator.fieldMode = newFieldMode;
				}
				newCreators.push(creator);
			}
			item.setCreators(newCreators);
			await item.save();
		}
	});
	return ids.length + " item(s) updated";
\end{lstlisting}


上面的JavaSc代码实现的功能也可以利用\href{https://github.com/redleafnew/zotero-updateifsE}{Green Frog}插件中的\menu{Tools-Toolbox-Author Bold and/or Asterisk}来实现，如\autoref{fig:ch5AuthorBold}所示
插件安装方法见\cref{sec:installPlug}，
本节的操作也可见
\href{https://zhuanlan.zhihu.com/p/353770101}
{Zotero使参考文献列表中某些作者名字加粗，加星，刷新后保留}。

%对作者加粗、加星
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.6]{ch5AuthorBold}
	\caption{利用\href{https://github.com/redleafnew/zotero-updateifsE}{Green Frog}插件对作者加粗、加星}
	\label{fig:ch5AuthorBold}
\end{figure}

\section{批量修改作者姓名为首字母大写}\label{sec:authorUpper}
某些网站文章利用Zotero connector导入Zotero后作者名字全部为大写，
如\href{https://pascal-francis.inist.fr/vibad/index.php?action=getRecordDetail&idt=PASCAL7536509928}
{HYDRODYNAMICS AND ENERGETICS OF FISH PROPULSION}
和\href{https://ci.nii.ac.jp/naid/10008557972/}
{CiNii Articles - Environmental factors and growth}
用Zotero插入Word中时，如果参考文献要求作者姓名首字母大写，
其余小写，通过修改csl文件中作者姓名大小写无法实现要求。
只能手动修改Zotero条目的作者大小写来实现，
一个一个作者修改太麻烦，参考以前代码，
编写了以下代码可以实现批量修改Zotero条
目中作者大小写为首字母大写其他小写。

实现方法：
\begin{enumerate}
	\item 在Zotero中将需要修改作者大小写的文献条目加上“try”的标签,
	不含引号，也可以改为其他的名称，在JavaScript代码中也相应修改即可）
	\item 复制以下代码：
	%批量修改作者姓名为首字母大写
	\begin{lstlisting}[language=JavaScript]
		var newFieldMode = 0; // 0: two-field, 1: one-field (with empty first name)
		var s = new Zotero.Search();
		s.libraryID = ZoteroPane.getSelectedLibraryID();
		var tagName = 'try'; //需要提前将需要修改的项目添加标签
		s.addCondition('tag', 'is', tagName);
		//s.addCondition('creator', 'is', oldName);
		
		var ids = await s.search();
		if (!ids.length) {
			return "No items found";
		}
		
		await Zotero.DB.executeTransaction(async function () {
			for (let id of ids) {
				var item = await Zotero.Items.getAsync(id);
				var creators = item.getCreators();
				
				let newCreators = [];
				for (let creator of creators) {
					creator.firstName = titleCase(creator.firstName.trim());
					creator.lastName = titleCase(creator.lastName.trim());
					creator.fieldMode = newFieldMode;
					newCreators.push(creator);
				} 
				item.setCreators(newCreators);
				await item.save();
			}  
			
		}); 
		return ids.length + "个条目作者变为作者首字母大写。";
		
		
		function titleCase(str) {    var newStr = str.split(" ");    for(var i = 0; i<newStr.length; i++){
				newStr[i] = newStr[i].slice(0,1).toUpperCase() + newStr[i].slice(1).toLowerCase();
			}    return newStr.join(" ");
		}
	\end{lstlisting}
	
	\item 在Zotero中依次点击Tools-Developer-Run JavaScript：
	\item 将JavaScript代码粘贴到代码框中，点击Run。
	则加try标签的文献作者就会改为作者大小写为首字母大写其他小写
	（无论作者以前是大写还是小写）。
	因为前面没有对作者大小写进行判断，因此，代码的输出值仅供参考。
\end{enumerate}


作者姓名批量修改为首字母大写具体操作也可见，
\href{https://zhuanlan.zhihu.com/p/354481222}
{Zotero作者姓名批量修改为首字母大写}。
首字母大写设置脚本参考了
\href{https://blog.csdn.net/dongjt_china/article/details/107283450#:~:text=%E5%9C%A8javascr,%EF%BC%8C%E5%85%B6%E4%BD%99%E9%83%A8%E5%88%86%E5%B0%8F%E5%86%99%E3%80%82}
{javascript如何设置字符串首字母大写}，
在此感谢。

\section{如何选中重复条目中的部分条目？}\label{sec:selectDup}	
在Zotero中，如果点击Duplicate Items（重复条目），
则所有重复条目都会被选中，
如一个条目如果有三个是重复的，则点击其中一个，这三个会同时被选中，
如何取消选择其中的部分条目呢？

其实很简单，只要按住\menu{Ctrl}键，再点击其中的一个条目，则此条就会取消选择。
参见\href{https://forums.zotero.org/discussion/91561/selection-one-of-duplicates}{Selection one of duplicates}。

\section{批量删除（合并）重复文献}\label{sec:DelDupBatch}				
前面讲述了删除（合并）重复文献的方法，见\cref{sec:delDup}，批量
删除（合并）重复文献的方法除了
用\keys{Ctrl+A}或点击\menu{Edit-Select All}选中所有重复文献
再点击\menu{Merge * items}方法外，也可以使用JavaScript
来批量删除。在Zotero中点击
左侧面板的\menu{Duplicate Items}，然后
依次点击：\menu{Tools-Developer-Run Javascript}，将以下代码复制到Code窗口中：

%批量删除（合并重复文献）
\begin{lstlisting}[language=JavaScript]
	var DupPane = Zotero.getZoteroPanes();
	for(var i = 0; i < 100; i++) {
		await new Promise(r => setTimeout(r, 1000));
		DupPane[0].mergeSelectedItems();
		Zotero_Duplicates_Pane.merge();
	}
\end{lstlisting}
点击\menu{Run}即可。源于
\url{https://forums.zotero.org/discussion/40457/merge-all-duplicates/}的
评论。

代码实现的原理为：实际上，是点击了100次"Merge X items"，每次点击之间1s
因此，如果你的重复文献更多，可以将代码中的100改为更大的数字。批量删除（合并）
重复文献的方法也可见于\href{https://zhuanlan.zhihu.com/p/352324486}
{Zotero批量删除（合并）重复文献}。批量删除（合并）重复文献的JavaScript
代码也可从\href{https://github.com/redleafnew/zotero-javascripts}
{zotero-javascripts}下载。
也可使用\href{https://chenglongma.com/zoplicate/}{Zoplicate}插件更智能地处理重复条目，它可以检测重复条目、批量处理重复条目、标记“非重复条目”、显示重复条目统计信息

\section{如何批量删除笔记}\label{sec:batchDelNotes}
有时从其它地方导入的条目有些多余的笔记，
如从\href{https://www.scopus.com}{Scopus}中导入的文献，每条中都有导出的日期和引用次数，
如\autoref{fig:ch5supNotes}所示：
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.5]{ch5supNotes}
	\caption{多余的笔记}
	\label{fig:ch5supNotes}
\end{figure}
而从EndNote XML中导入的文献条目会可能有：
The following values have no corresponding Zotero Field，参见
\href{https://forums.zotero.org/discussion/comment/390716#Comment_390716}{Selecting and deleting only notes}。
如果有上千条这样的条目，删除每条的笔记也很费时间，如何批量删除呢？有两个方法：
\begin{enumerate}
	\item 方法1安装delitemwithatt插件：
	下载地址\href{https://github.com/redleafnew/delitemwithatt}{https://github.com/redleafnew/delitemwithatt}，
	插件安装见\cref{sec:installPlug}，
	安装完成后，在需要删除笔记的条目上右击（可选多条），
	选择\menu{Delete Attachment(s)-Delete Notes only}，
	确认后即可将所选条目的笔记删除，如\autoref{fig:ch5delattPlug}所示：
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5delattPlug}
		\caption{仅删除笔记}
		\label{fig:ch5delattPlug}
	\end{figure}
	
	\item 方法2不安装插件，在搜索框中搜索需要删除的笔记的共同部分，
	如搜索“Export Date”，如\autoref{fig:ch5searchNotes}所示：
	
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5searchNotes}
		\caption{搜索笔记}
		\label{fig:ch5searchNotes}
	\end{figure}
	\item 然后在搜索的结果中点击需要删除的笔记，或按Ctrl+A全选，选择需要删除的笔记。
	右击，选择Move Items to Trash...，即可删除笔记。如\autoref{fig:ch5delNotes}所示：
	
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5delNotes}
		\caption{删除笔记}
		\label{fig:ch5delNotes}
	\end{figure}
	
	参考：\href{https://forums.zotero.org/discussion/comment/390716#Comment_390716}{Selecting and deleting only notes}。
\end{enumerate}

\section{author+year格式下，et al如何变为斜体？}\label{sec:etal_italic}

变为斜体的地方两个，一个是文中的引文部分（Inline Citations），
另一个是文末的参考文献列表部分（Bibliography）。
主要是通过修改style即csl文件实现的。修改csl文件可以通过Zotero
自带的Style Editor来完成（在Zotero中，
依次点击\menu{Edit-Settings-Cite},再点Tools下面的\menu{Style Editor}按钮），在左侧选择自己需要编辑的Style，然后进入编辑，完成点击\menu{Save As...}保存后使用，如\autoref{fig:ch5StyleEdit}所示。
但这种方法需要对csl语言比较熟悉。
	%run javascript
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.5]{ch5StyleEdit}
	\caption{运行JavaScript}
	\label{fig:ch5StyleEdit}
\end{figure}
另一种方法是通过csl文件在线编辑方式进行，操作比较直观。
下面以springer-basic-author-date 这种格式的csl进行修改。	
\begin{enumerate}
	\item 
	在浏览器地址栏中输入
	\href{https://editor.citationstyles.org/searchByName/}
	{https://editor.citationstyles.org/searchByName/}回车，
	然后搜索栏中输入style的名称，如springer-Basic，\menu{Search}，
	在下面的结果中Springer - Basic (author-date)下面的\menu{Edit}进行在线编辑，
	如\autoref{fig:ch5Search_style}所示。
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5Search_style}
		\caption{找到需要编辑的style}
		\label{fig:ch5Search_style}
	\end{figure}
	\item 先点击右侧的EXAMPLE CITATIONSG下面的作者，
	再点左侧Names下面的Et-al，如\autoref{fig:ch5Find_et al}所示。
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5Find_et al}
		\caption{找到\menu[,]{Et-al}}
		\label{fig:ch5Find_et al}
	\end{figure}
	\item 如果Names下面没有Et-al选项，点击上侧的\menu{+}，在弹出的对话框中\menu[,]{Et-al}，
	如\autoref{fig:ch5Click_etal}。
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5Click_etal}
		\caption{点击上面的\menu{+}}
		\label{fig:ch5Click_etal}
	\end{figure}
	\item 然后点击\menu{Text formatting}下面的\menu{I}按钮，如\autoref{fig:ch5Click_italic}所示。
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5Click_italic}
		\caption{点击\menu{I}按钮}
		\label{fig:ch5Click_italic}
	\end{figure}
\end{enumerate}
以上为文中的引文部分（Inline Citations）作者后面的et al改为斜体。
如果需要改Bibliography中作者后面的et al为斜体，过程一样，如果不需要，
可以跳转到\cref{it:StyleInfo}。
\begin{enumerate}
	\item 点击EXAMPLE BIBLIOGRAPHY下面的作者，再点击Names下面的\menu[,]{Et-al}，
	如果没有Et-al，按\menu{+}添加Et-al，如\autoref{fig:ch5Click_etal2}所示。
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5Click_etal2}
		\caption{找到BIBLIOGRAPHY下的\menu[,]{Et-al}}
		\label{fig:ch5Click_etal2}
	\end{figure}
	\item 在Text formatting下点击\menu{I}，使之为选中状态，如\autoref{fig:ch5Click_italic2}所示。
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5Click_italic2}
		\caption{点击\menu{I}按钮}
		\label{fig:ch5Click_italic2}
	\end{figure}
\end{enumerate}	


都修改完成以后，还要修改style信息：
\begin{enumerate} \label{it:StyleInfo}
	\item 点击STYLE INFO下面的\menu{info}，
	然后将Title（一般为投稿期刊的名称）和id设为唯一的值，
	防止覆盖本地的相同id的Style，如\autoref{fig:ch5Change_csl_title}所示。
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5Change_csl_title}
		\caption{修改Style的名称和id}
		\label{fig:ch5Change_csl_title}
	\end{figure}
	\item 然后依次\menu{Style-Save Style},保存Style，如\autoref{fig:ch5SaveStyle}所示。
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5SaveStyle}
		\caption{保存Style}
		\label{fig:ch5SaveStyle}
	\end{figure}
	\item 在弹出的对话框中点击确定，如\autoref{fig:ch5ClickSave}所示。
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5ClickSave}
		\caption{确定保存Style}
		\label{fig:ch5ClickSave}
	\end{figure}
	\item 在弹出的对话框中点击\menu{Download Style}，如\autoref{fig:ch5DownloadStyle}所示。
	如果点击\menu{Download Style}没有反应，将此对话框关闭，
	刷新一下页面，重复步骤2-4，将csl文件存到自己的位置。
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5DownloadStyle}
		\caption{下载Style文件到本地}
		\label{fig:ch5DownloadStyle}
	\end{figure}
	\item 在Zotero中添加此csl文件(见\cref{sec:addStyle})，
	在Word中格式化时选用此csl文件(见\cref{sec:changeStyle})。
	效果如\autoref{fig:ch5EtalItalicFinal}：
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5EtalItalicFinal}
		\caption{最终效果，et al都为斜体了}
		\label{fig:ch5EtalItalicFinal}
	\end{figure}
\end{enumerate}	

\section{在citationstyles.org可视化编辑csl时如何使用自己的文献调试？}\label{sec:csl_custom_citation}	

\href{https://editor.citationstyles.org/visualEditor/}{Visual CSL Editor}
\url{https://editor.citationstyles.org/visualEditor/} 
网站可以方便地可视化地编辑csl文件，上面预览窗口默认显示的网站内置的文献，形如：
\begin{lstlisting}[language=HTML]
	Hawking, S. (1966). Properties of expanding universes [Doctoral thesis, University of Cambridge]. https://doi.org/10.17863/CAM.11283
	Mares, I. (2001). Firms and the welfare state: When, why, and how does social policy matter to employers? In P. A. Hall & D. Soskice (Eds.), Varieties of capitalism. The institutional foundations of comparative advantage
	(pp. 184–213). Oxford University Press.
\end{lstlisting}
这两个参考文献，如果觉得不够直观，可以点击
右上角的\menu{Example citations}按钮添加更多网站内置的参考文献类型，
如果想用自己的参考文献来进行调试怎么办呢？
\begin{enumerate}
	\item 在Zotero中选中想作为例子的文献，右击选择\menu{Export Items...}，
	如\autoref{fig:ch5expItems}所示。
	%导出文献
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5expItems}
		\caption{导出拟作为例子的文献}
		\label{fig:ch5expItems}
	\end{figure}
	%选择导出格式
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5expJson}
		\caption{选择导出的格式为CSL JSON}
		\label{fig:ch5expJson}
	\end{figure}
	\item 在弹出的对话框中点击Format右边的菜单，选择导出的格式为CSL JSON，点击\menu{OK}，
	如\autoref{fig:ch5expJson}所示。
	\item 选择文件存放的目录，点击\menu{保存}，转到在上面目录中，
	用任意本文编辑器（如记事本）打开刚才保存的文件，按\keys{Ctrl+A}全选所有文字，按\keys{Ctrl+C}复制所有文字。
	在\href{https://editor.citationstyles.org/visualEditor/}{Visual CSL Editor}
	\url{https://editor.citationstyles.org/visualEditor/} 右侧点击\menu{Example citations}下的
	\menu{Citation 1}、\menu{Citation 2}或\menu{Citation 3}，在弹出的对话框靠下位置点击\menu{Advanced}，
	将刚才复制的参考文献粘贴到下面的文本框中，再点击\menu{Add new reference}，
	如\autoref{fig:ch5addRef}所示。
	%添加文献
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5addRef}
		\caption{添加自定义的文献}
		\label{fig:ch5addRef}
	\end{figure}
	%文献显示在EXAMPLE BIBLIOGRAPHY中
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.35]{ch5showInBib}
		\caption{文献显示在EXAMPLE BIBLIOGRAPHY中}
		\label{fig:ch5showInBib}
	\end{figure}
	\item 刚才复制的文献则会显示在上面，并处理选中状态。
	关闭此窗口，则会发现刚才的参考文献就会显示在EXAMPLE BIBLIOGRAPHY中，
	如\autoref{fig:ch5showInBib}所示。
	
	\item 如果不需要让它显示了，点击Example citations下的刚才点击的
	\menu{Citation 1}、\menu{Citation 2}或\menu{Citation 3}，
	将前面的勾去掉即可，或是点击 \menu{Reset all citations to default}，
	恢复为系统默认的参考文献。
\end{enumerate}
其它详细情况也可参见\href{https://zhuanlan.zhihu.com/p/437380542}
{在citationstyles.org可视化编辑csl时如何使用自己的文献调试}。

\section{如何删除参考文献列表末尾的点（.）？}\label{sec:bibPoint}	

\begin{enumerate}
	\item 可视化方法：在
	\href{http://editor.citationstyles.org/visualEditor/}{Visual CSL Editor} 
	\url{http://editor.citationstyles.org/visualEditor/}中依次点击\menu{Style-Load Style}，在弹出的界面选择自己的Style文件，上传到在线编译器中。如\autoref{fig:ch5loadStyle}所示。
	点击BIBLIOGRAPHY下面的\menu{Layout}，然后再将光标定位到右侧的suffix，
	按退格键或删除键将框中的点（.）删除，如\autoref{fig:ch5bibPoint}。
	再按\cref{sec:etal_italic}方法将编辑的csl保存，下载，然后应用到Word中即可。
		%删除suffix后面的点
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5loadStyle}
		\caption{加载Style}
		\label{fig:ch5loadStyle}
	\end{figure}
	
	%删除suffix后面的点
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5bibPoint}
		\caption{删除suffix后面的点}
		\label{fig:ch5bibPoint}
	\end{figure}
	%删除suffix后面的点
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.6]{ch5bibpointCode}
		\caption{通过编辑代码删除参考文献后面的点}
		\label{fig:ch5bibpointCode}
	\end{figure}			
	
	\item 修改代码方法：用任意文本编辑器（如VS Code）打开使用的csl文件，
	找到bibliography下面 
	\verb|<layout suffix=".">|	
	将里面的\verb|suffix="."|删除，如\autoref{fig:ch5bibpointCode}，
	保存，应用此style即可。
	
	
\end{enumerate}
\begin{note}
	（1）可以修改csl的id另存为其它csl，防止覆盖原来的文件。
	（2）china-national-standard-gb-t-7714-2015-numeric.csl的这个后缀点
	（.）在bibliography的layout中，但其它csl文件有可能放到了其它Macro中。
	（3）csl的添加，在Word中应用见\cref{sec:addStyle}。
\end{note}

\section{彻底解决参考文献显示网址及DOI问题}\label{sec:remove_doi}

\href{https://zhuanlan.zhihu.com/p/349555378}
{使用GB/7714-2015相关csl时文末显示的访问日期如何隐藏}
介绍了让参考文献末尾的网址隐藏的方法，
但很多人在使用过程中即使\menu{Include URLs of paper articles in references}
前的框中没有对勾但某些参考文献后面仍然有网址及DOI出现。
下面提供一个通过修改csl文件彻底解决这个问题。

在Zotero中点击\menu{Edit-Settings-Advanced-Show Data Directory}
打开你的数据文件夹，如\autoref{fig:ch5showDataDir}所示。
%显示数据文件夹
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.5]{ch5showDataDir}
	\caption{显示数据文件夹}
	\label{fig:ch5showDataDir}
\end{figure}
双击styles文件夹，找到你应用的style文件，
如china-national-standard-gb-t-7714-2015-note.csl，
用任何文本编辑器打开，如记事本、Notepad++、VS Code等，
找到控制访问日期/DOI和URL的字段，
将其删除或注释（在需要注释的代码前加<!--，后面加-->，如：

\begin{lstlisting}[language=HTML]
	<!--<text macro="accessed-date"/>
	<group delimiter=". " prefix=". ">
	<text variable="URL"/>
	<text variable="DOI" prefix="DOI:"/>
	</group>-->
\end{lstlisting}							
然后保存csl文件，在Word文件中刷新一下用此csl的文件，
看看DOI、网址、访问日期等是否消失了。
如果没有变化，在Word中的Zotero工具条上点击
\menu{Document Preferences}，切换为其他style，
点击\menu{确定}。然后再点击\menu{Document Preferences}切换回原来的style，
访问日期、网址、DOI等应该会消失。

\begin{note}
	（1）note类的csl可能需要删除\verb|<citation></citation>|
	和 \verb|<bibliography></bibliography>|之间两处的代码。
	（2）不同的csl标注访问日期、网址、DOI用的宏可能不同，需要仔细查找。
	（3）可以将csl上传到	\href{http://editor.citationstyles.org/visualEditor/}{Visual CSL Editor}在线可视编辑style，完成后再下载下来，安装。
	（4）如果产生错误，将注释标记删除，恢复原样。
	（5）当然你也可以将Zotero库中访问日期、URL、DOI字段删除，不修改csl应该也可以，
	但不推荐，会损坏参考文献的完整性。
\end{note}

\section{Word参考文献条目末尾有DOI，但CSL代码找不到相应字段修改，怎么办？}\label{sec:no_doi}

Word参考文献列表条目末尾有DOI，一般可以通过修改相应的csl文件中DOI或URL字段
（将其删除或注释）即可让其不显示，见\cref{sec:remove_doi}。但是有些csl文件中没有任何DOI或URL相关的字段，
这是怎么回事呢？又如何修改呢。

其实csl从是否依赖其它csl文件上分类分为两类，即独立型（dependent）
和非独立型（依赖型，independent），两者的区别见\url{https://docs.citationstyles.org/en/stable/specification.html#file-types},如果一个csl文件的内容很少
，基本就可以判断它是非独立型的了。准确的判断方法是，打开csl文件，
看前面的链接（link），如果链接中有“independent-parent”字样，
那它就是非独立型的了。

如：acs-applied-materials-and-interfaces.csl这个文件：
\begin{lstlisting}[language=HTML]
	<link href="http://www.zotero.org/styles/acs-applied-materials-and-interfaces" rel="self"/>
	<link href="http://www.zotero.org/styles/american-chemical-society" rel="independent-parent"/>
\end{lstlisting}	
说明这个csl是和american-chemical-society的是相同的。

非独立型csl存在的意义在于，某些出版社（如ACS、Elsevier）
出版的杂志其样式是一样的，如果要修改的话，
只需要修改independent-parent这个就可以了，不用一本杂志一本杂志的修改，比较简单。

明白了其中的原理，解决问题就比较简单了。
以acs-applied-materials-and-interfaces.csl文件修改为例，看一下如何修改：

在浏览器地址中输入independent-parent前面这个链接的地址，
如\url{http://www.zotero.org/styles/american-chemical-society}，
\menu{回车}。如果浏览器安装了Zotero Connector插件，
则会提示是否将此样式文件添加到Zotero中，
添加后在Zotero的数据目录（Zotero数据目录见\cref{sec:remove_doi}）的styles文件夹中找到这个csl文件，
用任意文本编辑器（如记事本、\href{https://code.visualstudio.com/Download}{VS Code}等）打开，然后按\cref{sec:remove_doi} 方法修改即可。
本例中为倒数第三行：
\begin{lstlisting}[language=HTML]
	<text variable="DOI" prefix=". https://doi.org/"/>
\end{lstlisting}
将此句删除或注释（在此句首尾分别添加<!--和 -->）即可。
\begin{lstlisting}[language=HTML]
	<!-- <text variable="DOI" prefix=". https://doi.org/"/> -->
\end{lstlisting}
然后修改前面的title和id防止覆盖现在的American Chemical Society，
将文件另存为其它文件名，再在Zotero重新添加此文件。
\begin{lstlisting}[language=HTML]
	<info>
	<title>American Chemical Society Custom</title>
	<title-short>ACS</title-short>
	<id>http://www.zotero.org/styles/american-chemical-society-custom</id>
\end{lstlisting}
在Word中插入文献时使用此样式文件即可，见\cref{sec:changeStyle}和\cref{sec:addStyle}。


如何选择不同的csl 文件见\url{https://zhuanlan.zhihu.com/p/64625049}，
如何添加csl 格式文件见\url{https://zhuanlan.zhihu.com/p/64624484}，或
见\cref{ch:insert}。

\section{正文中如何实现作者（年代）的引文格式？}\label{sec:author_year}
在作者-年代引用格式中，一般引用格式为“（作者，年代）”如“...没有发现相关性（张三，2017）”，
但有时作者放在前面，引用格式为：“作者（年代）”，如“张三（2017）发现了...”，
在EndNote实现比较简单，只需要在引用处右击，选择\menu{Display as Author （year）}即可。
在Zotero现在没有直接实现的方法。根据Zotero论坛的方法，可以用如下的方法实现：
\begin{enumerate}
	\item 用正常的方法插入文献。形成的格式为：\label{it:copyAuthor}
	\begin{lstlisting}[language=HTML]
		(Abbas et al. 2008) examined the color of PSE turkey meat and found that the L* value was significantly negative correlated.
		
		Abbas FMA, Foroogh B, Liong MT, Azhar ME. 2008. Multivariate statistical analysis of antioxidants in dates (phoenix dactylifera). Int. Food Res. J. 15(2):193–200
	\end{lstlisting}
	\item 然后依次点击Word中Zotero工具条，\menu{Add/Edit Citation-Z-Class View}，
	如\autoref{fig:ch5ClassicView}所示。
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5ClassicView}
		\caption{切的为经典视图}
		\label{fig:ch5ClassicView}
	\end{figure}
	\item 在弹出的对话框中\menu{Suppress Author}前面的复选框，再点击\menu{OK}，
	如\autoref{fig:ch5SupressAuthor}所示。
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5SupressAuthor}
		\caption{不显示作者}
		\label{fig:ch5SupressAuthor}
	\end{figure}
	\item 然后手动输入作者姓名或是在前面步骤中复制作者名字，在此处粘贴即可，
	最终效果如\autoref{fig:ch5Author-year}所示。
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5Author-year}
		\caption{作者(年代)的最终效果}
		\label{fig:ch5Author-year}
	\end{figure}
\end{enumerate}
也可以使用\href{https://getquicker.net/Sharedaction?code=c9c174a1-8ad8-46b7-4cd9-08da16aad73c}{切换作者}\href{https://getquicker.net/}{Quicker}动作自动实现。

\section{设置文献题目中的斜体、上（下）标}\label{sec:italic}
一些论文的题目由于是拉丁单词或其它原因需要在参考文献中表现为斜体：
如\textit{in vitro}， \textit{longissimus thoraci}，
要改为斜体，可以在插入参考文献后在Word中用字体中的\menu{I}按钮实现，
但是这种方法在参考文献刷新后需要重新设置。
下面的方法可以在刷新或再插入、删除文献后斜体保持不变，
主要是通过修改Zotero中该文献的条目的题目来实现的。
\begin{enumerate}
	\item 在Zotero中找到这条文献，然后在需要显示为斜体的单词两侧分别加上
	<i>和</i>，如\autoref{fig:ch5Title_italic}所示。
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5Title_italic}
		\caption{在Zotero中，在需要显示为斜体的单词两侧分别加上<i>和</i>}
		\label{fig:ch5Title_italic}
	\end{figure}
	\item 在Word中点击\menu{Refresh}刷新已经插入的文献，加了标记的单词就会是斜体了，以后再插入参考文献，
	斜体的效果不会变化，最终效果如\autoref{fig:ch5ItalicFinal}所示。

	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.45]{ch5ItalicFinal}
		\caption{在Word中的最终效果}
		\label{fig:ch5ItalicFinal}
	\end{figure}
\end{enumerate}
\vspace{1em}

同样的方法可以设置上标、下标，在需要设置的词两侧加上相应的标记符：

\verb|<sup>上标</sup> |	

\verb|<sub>下标</sub> |

\section{文献题目中的大小写问题}\label{sec:case}
有些期刊或出版社（如ACS）导出的文章题目（Title）是每个实词的首字母是大写，
如\autoref{fig:ch5ACS_Title}所示，这样导入到Zotero中也是如此\footnote{Zotero 7.0中现在导入ACS文献后题目会自动变为Sentence格式大小写了，在此仅为举例。}。
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.5]{ch5ACS_Title}
	\caption{ACS某些期刊论文的题目是每个单词首字母大写}
	\label{fig:ch5ACS_Title}
\end{figure}	

但多数杂志要求参考文献题目是句子（\href{https://www.grammarly.com/blog/title-case-sentence-case/}{Sentence}）格式，
即只是题目的首字母大写（缩写除外，都是大写），在Zotero中转换的方法如下：

选中文章，在右侧文章信息Info中Title字段处右击，
选择\menu{Sentence case}，
然后再把缩略语等需要大写的手动修改一下。如\autoref{fig:ch5Title_case}所示：

\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.5]{ch5Title_case}
	\caption{在Zotero中更改题目大小写的方法}
	\label{fig:ch5Title_case}
\end{figure}


上面提到的方法仅适用于少数几条文献，如果参考文献标题每个单词首字母大写的文献比较多，
需要用到批量转换的方法(操作有风险，建议先备份库再进行下面的操作)。
\begin{enumerate}
	\item 选中需要转换的文献，
	依次点击：\menu{Tools-Developer-Run Javascript}，
	如\autoref{fig:ch5RunJavaScript}所示：
	
	%run javascript
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.6]{ch5RunJavaScript}
		\caption{运行JavaScript}
		\label{fig:ch5RunJavaScript}
	\end{figure}
	\item 在弹出的对话框中将以下代码复制进去，
	如\autoref{fig:ch5RunJavaScript1}所示：
	
	%JavaScript
	\begin{lstlisting}[language=JavaScript]
		zoteroPane = Zotero.getActiveZoteroPane();
		items = zoteroPane.getSelectedItems();
		var result = "";
		for (item of items) {
			var title = item.getField('title');
			result += " " + title + "\n";
			var new_title = title.replace(/\b([A-Z][a-z0-9]+|A)\b/g, function (x) { return x.toLowerCase(); });
			new_title = new_title.replace(/(^|\?\s*)[a-z]/, function (x) { return x.toUpperCase(); });
			result += "-> " + new_title + "\n\n";
			// // Do it at your own risk
			item.setField('title', new_title);
			await item.saveTx();
		}
		return result;
	\end{lstlisting}
	\item 点击\autoref{fig:ch5RunJavaScript1}中的\menu{Run}按钮，右侧会显示题目的修改情况。
	%run javascript
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5RunJavaScript1}
		\caption{运行JavaScript}
		\label{fig:ch5RunJavaScript1}
	\end{figure}
	\item 关闭\autoref{fig:ch5RunJavaScript1}窗口，则在Zotero主窗口发现已经修改完成，
	都成为句首字母大写，最好再核实一下，如果有不正确的，手动再修改一下。
	\item 其他情况，包括视频操作见\href{https://zhuanlan.zhihu.com/p/283889592}
	{[Zotero]批量文章题目大小写转为首字母大写的方法（含视频）}及
	\href{https://zhuanlan.zhihu.com/p/60651053}
	{[Zotero]文章题目大小写转为首字母大写的方法}。
\end{enumerate}

\section{Word中用Zotero插入的文献是类似乱码的域代码}\label{sec:field_code}
有时候用Zotero在Word中插入文献后显示得类似乱码，如\autoref{fig:ch5Field_code}所示，	
这样可能是显示问题，可以试试按\keys{Alt+F9}。
根据\href{https://link.zhihu.com/?target=https\%3A//zhidao.baidu.com/question/158669989.html}
{百度知道}\keys{Alt + F9}的意思是：
在Microsof Office 的 Word 中
\keys{Alt+F9}组合键的作用：显示或隐藏文档中所有域代码。
Word域的含义，Word域的中文意思是范围，类似数据库中的字段，
实际上，它就是Word文档中的一些字段。每个Word域都有一个唯一的名字，但有不同的取值。
例如：
域代码{DATE\* MERGEFORMAT }在文档中每个出现此域代码的地方插入当前日期，
其中"DATE"是域类型，"\*MERGEFORMAT"是通用域开关。
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.5]{ch5Field_code}
	\caption{Word中插入文献后显示得类似乱码}
	\label{fig:ch5Field_code}
\end{figure}


除了按\keys{Alt + F9}，也可以试试在乱码（域代码）的地方右击，再点击\keys{切换域代码}。

\section{Word中没有Zotero工具条的解决办法之一}\label{sec:tool_bar}
在安装软件时，应该先安装Word再安装Zotero，如果仍然没有工具条(一些绿色精简版的Word中可能会存在这些情况),	    	
解决办法是：
\begin{enumerate}
	\item 关闭Word，在Zotero中依次点击\menu{Edit-Settings-Cite}，在弹出的对话框中，
	点击\menu{Install Microsoft Word Add in}或\menu{Reinstall Microsoft Word Add in}，
	如\autoref{fig:ch5InstallWordPlugin}所示，然后在弹出的对话框中点击\menu{OK}，
	如\autoref{fig:ch5InstallWordPluginOK}所示。
	打开Word看一下Zotero工具条是不是出现了。
	
	%Word工具条安装
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5InstallWordPlugin}
		\caption{Zotero在Word中工具条安装}
		\label{fig:ch5InstallWordPlugin}
	\end{figure}
	
	%Word工具条安装
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.6]{ch5InstallWordPluginOK}
		\caption{Zoter在Word中工具条安装完成提示}
		\label{fig:ch5InstallWordPluginOK}
	\end{figure}
	\item 如果还不行，
	可以尝试将Zotero安装目录中的模板文件手动复制到Word的启动目录中。
	如：将
	
	\winpath{D:\Zotero\integration\word-for-windows\Zotero.dotm}
	复制到
	\winpath{C:\Users\<YourName>\AppData\Roaming\Microsoft\Word\STARTUP}中。
	或是尝试以管理员模式启动Word。
	
	
	详细情况可参见\href{https://zhuanlan.zhihu.com/p/58931999}
	{Word中没有Zotero工具条的解决办法之一}。
	 
	\end{enumerate}
	查看Word启动目录的方法见\href{https://zhuanlan.zhihu.com/p/85513418}
	{找到Word启动位置的方法}。

\section{插入文献后为什么显示为脚注或尾注？}\label{sec:footnotes}
有时在Word中插入参考文献使用China National Standard GB/T 7714-2015 csl
文件插入参考文献后显示为脚注或尾注，而且编号是罗马数字，如\autoref{fig:ch5footnotes}所示:
\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.5]{ch5footnotes}
	\caption{参考文献显示为脚注}
	\label{fig:ch5footnotes}
\end{figure}
产生这个问题的原因是选用的csl文件（csl文件名称中可能含有note字样）
生成的是脚注或尾注格式的参考文献，
确认的方式是在Word中的Zotero工具条上点击\menu{Document Preferences}，
看下Language下是否为Display Citation As: Footnotes或Endnotes，
如果是，这就是生成这样参考文献的原因。
而参考文献在文章末尾的应该是Store Citation As: Field, Bookmark。 
如果将显示为传统的在文章末尾，可以按以下步骤：
\begin{enumerate}

	\item 
	在Word中的Zotero工具条上点击\menu{Document Preferences}，
	选择China National Standard GB/T 7714-2015 （numeric, Chinese）,
	不要选择带note字样的。点击\menu{OK}，如\autoref{ch5changeStyle}。
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.5]{ch5changeStyle}
		\caption{切换为不带note的style显示效果}
		\label{ch5changeStyle}
	\end{figure}
	\item 
	如果参考文献还是没有在文章末尾出现，点击工具条上的\menu{Add Bibliography}，
	正常情况下参考文献应该会出现在文章末尾，如\autoref{ch5EndofArt}所示。
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.5]{ch5EndofArt}
		\caption{切换为不带note的style}
		\label{ch5EndofArt}
	\end{figure}
\end{enumerate}


以上过程实际上是更改sytle的过程，如\cref{sec:changeStyle}所述。

\section{Word中加载zotero工具条时提示加载宏的取消方法}\label{sec:load_mac}
如果先安装的Zotero然后安装的Office或是由于各种原因重装Office，
重新安装Zotero在Word中的工具条后在启动Word可能会有
如\autoref{fig:ch5WordMacroDisabled}的对话框:
\begin{figure}[htbp]
	\centering
	\includegraphics[scale=0.6]{ch5WordMacroDisabled}
	\caption{提示宏已被禁用的安全警告}
	\label{fig:ch5WordMacroDisabled}
	%	\end{minipage}
	\end{figure}
	
	取消这些安全警告的方法：
	
	在Word中依次点击\menu{文件-选项-信任中心-信任中心设置-受信任位置-添加新位置}，
	将启动目录填写进去。    	
	如\winpath{C:\Users\<YourName>\AppData\Roaming\Microsoft\Word\STARTUP}。
	如\autoref{fig:ch5AddTrustedLoc}所示。
	\begin{figure}[ht]
\centering
\includegraphics[scale=1.0]{ch5AddTrustedLoc}
\caption{将启动目录添加到受信任位置}
\label{fig:ch5AddTrustedLoc}
\end{figure}

%\section{如何设置打开PDF附件的软件}\label{sec:open_PDF}
%默认情况下，Zotero中打开PDF附件使用的是Zotero内置浏览器，
%可以通过下面的步骤自定义打开PDF附件的软件。
%\begin{enumerate}
%	\item 在Zotero中依次点击\menu{Edit-Settings-General}。
%	\item 点击Open PDFs using 后面\menu{Zotero}。
%	
%	\begin{figure}[ht]
%		\centering
%		\includegraphics[scale=0.6]{ch5open-pdf-app}
%		\caption{自定义打开PDF的软件}
%		\label{fig:ch5open-pdf-app}
%	\end{figure}
%	
%	\begin{figure}[ht]
%		\centering
%		\includegraphics[scale=0.6]{ch4attangerOpen}
%		\caption{使用\href{https://github.com/MuiseDestiny/zotero-attanger}{Zotero Attanger}自定义打开PDF的软件}
%		\label{fig:ch4attangerOpen}
%	\end{figure}
%	\item 点击 \menu{Custom...}，如\autoref{fig:ch5open-pdf-app}所示。
%	\item 浏览找到打开PDF文件软件的可执行文件，点击\menu{打开}，
%	然后在接下来的对话框中点击\menu{OK}即可
%	\item 在Zotero中双击带PDF的附件的条目或PDF附件。
%	\item 打开的软件可能会提示是否设置PDF文件关联，根据自己的需要点击\menu{是}或\menu{否}。
%\end{enumerate}
%安装\href{https://github.com/MuiseDestiny/zotero-attanger}{Zotero Attanger}插件后，右击PDF附件，也可以选择使用什么软件打开附件，更详细的介绍也可参见\href{https://zhuanlan.zhihu.com/p/373952017}
%{Zotero如何设置打开PDF附件的软件}。

\section{中文PDF导入方法}\label{sec:Chinese_PDF}
英文PDF文件导入到Zotero中的方法比较简单，见\cref{sec:EngPDFIm},
而中文PDF中可能不包含元信息，不能按\cref{sec:EngPDFIm}方法导入。
需要安装jasminum(茉莉花)插件，导入的原理是插件根据PDF文件的文件名
(一般是文献的题目和作者)从知网上抓取相关的信息并导入到Zotero库中。
具体步骤如下：
\begin{enumerate}
	\item 到\url{https://github.com/l0o0/jasminum/releases}
	上右击jasminum\_x.xpi(x为插件的版本，注意根据自己的Zotero版本选择相应的茉莉花版本)，选择\menu{链接另存为(K)}，
	将jasminum插件下载自己的目录，如桌面，如图\autoref{fig:ch5jasminum_down}所示：
	%jasminum下载
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.8]{ch5jasminum_down}
		\caption{jasminum下载}
		\label{fig:ch5jasminum_down}
	\end{figure}
	\item 在Zotero中依次点击\menu{Tools-Plugins}，
	在弹出的界面中点击\menu{齿轮-Install Plugin From File...}
	在弹出的对话框中找到下载的jasminum\_*.xpi插件（*为版本号），点击\menu{打开},
	等待安装完成。
	插件(扩展)的方法也可见\cref{sec:installPlug}。
	\item 将中文论文拖到Zotero库中，如\autoref{fig:ch5Drag_Chinese_PDF}所示：
	%拖动中文PDF
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.6]{ch5Drag_Chinese_PDF}
		\caption{拖动中文PDF到Zotero库中}
		\label{fig:ch5Drag_Chinese_PDF}
	\end{figure}
	\item 在文献上右击，再点击\menu{ CNKI-CNKI Metadata}，
	如\autoref{fig:ch5Retrive_CNKI}所示：
	%抓取CNKI元信息
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.6]{ch5Retrive_CNKI}
		\caption{抓取CNKI元信息}
		\label{fig:ch5Retrive_CNKI}
	\end{figure}
	\item 识别结果如\autoref{fig:ch5CNKI_retrive_res}所示：
	%识别结果
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.5]{ch5CNKI_retrive_res}
		\caption{CNKI抓取结果}
		\label{fig:ch5CNKI_retrive_res}
	\end{figure}
	\item 如果安装\href{https://github.com/MuiseDestiny/zotero-attanger}{Zotero Attanger}插件，可以对附件进行重命名，移动到自己的附件文件夹,
	见\cref{sec:AttangerPre}。
	\item 能够识别以下情况，作者姓名为4字以内，CNKI下载的能较好识别。
	title\_author.*、
	title.*、
	titlePart1\_titlePart2\_author.*、
	titlePart1\_titlePart2.*。*为扩展名，包括caj和PDF。
	另外，这个插件可能会随着CNKI的升级而失效，如果失效需要到原来的下载网站
	\url{https://github.com/l0o0/jasminum/releases}下载新版插件安装或到其
	这个网站上反馈。
	
\end{enumerate}

\section{Zotero条目右键菜单中为什么没有Find Available PDF？}\label{sec:Find_PDF}	
一般情况下在Zotero条目上右击会出现\menu{Find Available PDF}，如果没有出现，可能是以下两种情况：
\begin{enumerate}
	\item 条目本来已经有PDF附件，右键菜单会显示\menu{View PDF}。
	\item 条目的URL和DOI两个字段都是空的。
\end{enumerate}
详情参见\href{https://zhuanlan.zhihu.com/p/348697024}
{[Zotero]右键菜单中为什么没有Find Available PDF？}

\section{Zotero删除条目（题录）时同时删除PDF附件的方法}\label{sec:Delete_attach}						
在Zotero中如果安装了\href{https://github.com/MuiseDestiny/zotero-attanger}{Zotero Attanger}插件后，
在添加附件时默认会自动将PDF附件移动到自定义的文件夹内，
给PDF的管理带来很大方便，但也带来一个问题，
就是在Zotero中删除条目（题录）时链接的PDF无法自动删除。
当前的解决方法是：

方法1：在删除条目之前先通过右击PDF选择\menu{Show File}找到该文件，
先删除该PDF文件，再删除条目。

方法2：将\menu{转换已链接文件为已存储文件}菜单，
然后再删除条目可以同时PDF附件，具体步骤如下：
\begin{enumerate}

 
	\item 选中删除的条目，点击
	\menu{Tools-Manage Attachments-Convert Linked Files to Stored Files...}
	\item 在弹出的对话框中勾选\menu{Delete original files after storing}，
	再点击\menu{Continue}；
	\item 然后再选中需要删除的条目，右击选择\menu{Move Items to Trash...}；
	\item 在弹出的对话框中点击\menu{OK}；
	\item 然后右击\menu{Trash}，点击\menu{Empty Trash}；
	\item 在最后的确认对话框中点\menu{OK}；最终PDF会一块删除。
\end{enumerate}

注意：只有在清除垃圾箱后对应的PDF才会删除。

方法3：
可以使用\href{https://github.com/redleafnew/delitemwithatt/releases}{delitemwithatt.xpi
}插件。安装结束后，在条目上右击会出现如\autoref{fig:ch5delitem}所示的菜单，根据需要
可以选择删除条目及附件，仅删除附件，删除快照等。


%删除条目的同时删除附件
\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.5]{ch5delitem}
	\caption{安装delitemwithatt插件后出现的右键菜单}
	\label{fig:ch5delitem}
\end{figure}

Zotero安装ZotFile后删除条目和附件的上面所述方法可见
\href{https://zhuanlan.zhihu.com/p/369141058}{Zotero安装ZotFile后删除条目和附件视频讲解}。

\section{Zotero生成双语参考文献的变通实现方法}\label{sec:Biolan}
为满足期刊论文国际交流需要，现在很多中文期刊要求中文参考文献需增加英文引用格式，
排于对应的中文文献下方，如《农业工程学报》、《食品与发酵工业》等。
现在的文献管理软件基本上没有现成的解决方法，下面提供一个变通的方法，
通过把英文引用格式放到Zotero的Short Title字段，然后修改csl文件，
在末尾添加这个字段来实现。EndNote也可以按这个原则来实现。
\begin{enumerate}
	\item 先将中文参考文献翻译为其对应的英文格式，
	如果原来的中文参考文献全文有其对应的格式优先选用原文的，
	没有的话再翻译。如将：
	\begin{lstlisting}[language=VBScript]
		唐霄, 孙杨赢, 江雪婷, 等. 不同蛋白酶制备鹅肉呈味肽的对比分析[J]. 食品科学, 2019, 40(22): 141-146.
	\end{lstlisting}
	翻译为：
	\begin{lstlisting}
		TANG X,SUN Y Y,JIANG X T,etal. Comparative analysis of flavor peptides prepared by enzymatic hydrolysis of goosemeat with different proteases [J]. Food Science, 2019, 40(22): 141-146.
	\end{lstlisting}
	将翻译的英文格式添加到Zotero库的对应中文条目的Short Title中，
	如\autoref{fig:ch5Short_title}所示：
	%将翻译的英文格式添加到Zotero库的对应中文条目的Short Title中
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.6]{ch5Short_title}
		\caption{将翻译的英文格式添加到Zotero库的对应中文条目的Short Title中}
		\label{fig:ch5Short_title}
	\end{figure}
	\item 在Zotero中点击\menu{Edit-Settings-Advanced-
		Show Data Directory}找到自己使用的数据文件夹(数据文件夹在\cref{sec:data_dir}提到)，
	进入styles文件夹，
	如\autoref{fig:ch5showDataDir2}，\autoref{fig:ch5Styles}所示：
	%找到Zotero的数据文件夹
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.5]{ch5showDataDir}
		\caption{显示Zotero的数据文件夹}
		\label{fig:ch5showDataDir2}
	\end{figure}
	%找到styles文件夹
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.6]{ch5Styles}
		\caption{找到Zotero的数据文件夹}
		\label{fig:ch5Styles}
	\end{figure}
	\item 找到csl文件，
	以China National Standard GB/T 7714-2015 
	(numeric, Chinese)（
	下载地址\url{http://www.zotero.org/styles/china-national-standard-gb-t-7714-2015-numeric}）进行说明。
	\item 	用文本编辑器，如记事本，打开此文件，
	将 second-field-align="flush" 删除，如\autoref{fig:ch5Delete_flush}所示：
	%将 second-field-align="flush" 删除
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.6]{ch5Delete_flush}
		\caption{将 second-field-align="flush" 删除}
		\label{fig:ch5Delete_flush}
	\end{figure}
	\item 在文件近末尾的地方加入：
	\begin{lstlisting}[language=VBScript]
		<text variable="title-short" display="block" suffix=". "/>
	\end{lstlisting}
	保存此文件，如\autoref{fig:ch5Add_short_title}所示：
	%添加Short Title字段
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.6]{ch5Add_short_title}
		\caption{添加Short Title字段}
		\label{fig:ch5Add_short_title}
	\end{figure}
	\item 在Word中格式化参考文献时选择此style就可以了，
	如\autoref{fig:ch5GB7714}所示：
	%在Word中选用此style
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.6]{ch5GB7714}
		\caption{在Word中选用此style}
		\label{fig:ch5GB7714}
	\end{figure}
	\item 最终效果如下：
	\begin{lstlisting}
		[1] 唐霄, 孙杨赢, 江雪婷, 等. 不同蛋白酶制备鹅肉呈味肽的对比分析[J]. 食品科学, 2019, 40(22): 141-146. 
		TANG X,SUN Y Y,JIANG X T,etal. Comparative analysis of flavor peptides prepared by enzymatic hydrolysis of goosemeat with different proteases [J]. Food Science, 2019, 40(22): 141-146.
		
		[2] SUKAN G, ANDREWS A T. Application of the plastein reaction to caseins and to skim-milk powder: I. Protein hydrolysis and plastein formation[J]. Journal of Dairy Research, 1982,49(2):265–278. 
		Application of the plastein reaction to caseins and to skim-milk powder.
		
		[3] UDENIGWE C C, WU S, DRUMMOND K, 等. Revisiting the prospects of plastein: thermal and simulated gastric stability in relation to the antioxidative capacity of casein plastein[J]. Journal of Agricultural and Food Chemistry, 2014,62(1):130–135. 
		Revisiting the prospects of plastein.
		
		[4] 张娟娟, 刘尊英, 董士远, 等. 锌离子结合类蛋白反应修饰肽的稳定性研究[J]. 现代食品科技, 2015,31(09):150–154. 
		ZHANG J J,LIU J Y,DONG S Y,et al. Stability of modified peptide using zinc binding and plastein reaction [J]. Modern Food Science and Technology, 2015, 31(09): 150–154.
		
		[5] 朱磊, 张馨心, 谢艳英, 等. 类蛋白反应的作用机制及其对海洋源蛋白修饰的研究进展[J]. 食品工业科技, 2020,41(09):362–367. 
		ZHU L,ZHANG X X,XIE Y Y,et al. Research progress on mechanism of plastein reactions and its modification function of marine proteins [J]. Science and Technology of Food Industry, 2020, 41(09): 362–367.
	\end{lstlisting}
	\item 如果自己不愿意修改csl文件，可以下载我修改的，放到自己能找到位置。下载地址：
	\url{https://www.jianguoyun.com/p/DU5V1AkQtOD-BRjtqcwD}，
	然后在Zotero中点击\menu{Edit-Settings-Cite}，点击\menu{+}，
	找到刚才下载的csl文件，添加此style文件。
	具体过程可以参考：\cref{sec:addStyle}
	或\href{https://zhuanlan.zhihu.com/p/64624484}{[Zotero]如何添加csl格式文件？}
	\item 	
	最后在Word中格式化参考文献时选择
	chinese-gb7714-2015-AuUp-Bilan这个style就可以了，
	如\autoref{fig:ch5Bilan}所示：
	%在Word中选用Chinese Std GB/T 7714-2015-AuUp-Bilan style
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.6]{ch5Bilan}
		\caption{在Word中选用Chinese Std GB/T 7714-2015-AuUp-Bilan style}
		\label{fig:ch5Bilan}
	\end{figure}
	
	\item 	具体实现过程及视频操作过程也可参见
	\href{https://zhuanlan.zhihu.com/p/282826403}
	{[Zotero]生成双语参考文献的变通实现方法}。
\end{enumerate}

%~\\ %添加空行，也可用\[行距]：可加入任意间距的空白行 [xpt]

但是本方案还不太完美。如果原来的文献有Short Title会显示异常，
如本例中参考文献2，显示了多余的内容。
另外，相应的中文格式后面不家一个空行，需要手动删除。

\section{Zotero生成的参考文献列表中页码和日期间隔符号如何由“–”改为“-”}\label{sec:DashToHyphen}		
Zotero的style中默认的页码范围和日期中年月日的间隔是“–”（en dash），
如果需要改为“-”（hyphen）怎么办呢？本节以
China National Standard GB/T 7714-2005 （numeric， Chinese）这个style为例讲述一下操作方法：
\begin{enumerate}
	\item 用文本编辑器，如记事本、\href{https://code.visualstudio.com/}{Visual Studio Code}等软件打开自己数据文件夹下\winpath{styles}目录中的
	chinese-gb7714-2005-numeric.csl文件(数据文件夹在\cref{sec:data_dir}提到)。
	\item 在\verb|<info>|后面加入下面的代码，如\autoref{fig:ch5page_del}所示：
	
	\begin{lstlisting}[language=XML]	
		<locale xml:lang="zh-CN">
		<terms>
		<term name="page-range-delimiter">-</term>
		</terms>
		</locale>
		<locale xml:lang="en">
		<terms>
		<term name="page-range-delimiter">-</term>
		</terms>
		</locale>
	\end{lstlisting}				
	%添加页码范围
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.7]{ch5page_del}
		\caption{修改页码范围的间隔符}
		\label{fig:ch5page_del}
	\end{figure}
	\item 保存Style。
	\item 在Word中如果当前选用的是China National Standard GB/T 7714-2005 （numeric， Chinese）
	点击\keys{Refresh}，如果不是切换为China National Standard GB/T 7714-2005 （numeric， Chinese），
	看一下效果页码范围中的“–”是否已经改为“-”
	（如果列表中没有刚才编辑的style，点击Manage Style，点击\menu{+}找到刚才编辑的style，添加进去。
\end{enumerate}

修改页码间隔的方法来源于：\href{https://forums.zotero.org/discussion/comment/320230#Comment_320230}
{Zotero官方论坛}。

日期中间隔符号修改方法类似，打开Style文件，
在里面搜索 \verb|<macro name="accessed-date">|，
将此宏下面的\verb|delimiter="&#8211;"|或\verb|delimiter="–"|修改为\verb|delimiter="-"|，
如\autoref{fig:ch5date_del}所示。
%修改日期的间隔符
\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.7]{ch5date_del}
	\caption{修改日期的间隔符}
	\label{fig:ch5date_del}
\end{figure}
然后再搜索\verb|<macro name="issued-date">|，同样处理。保存Style文件；
然后在Word的Zotero工具条中点击刷新，或点击Document Preferences切换为其他Style再切换回来；		
看看日期间隔中“–”是否修改改为“-”。

\section{数字格式的Style参考文献列表编号位数增加后如何对齐？}\label{sec:align}	
有的Style参考文献编号位数增加后不对齐了（如从9增加到10后，从1位增加到2位）
如\autoref{fig:ch5non-align}所示：
%参考文献编号增加后不再对齐
\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.4]{ch5non-align}
	\caption{参考文献编号增加后显示不对齐}
	\label{fig:ch5non-align}
\end{figure}
可以通过修改style文件来解决：
\begin{enumerate}
	\item 用任何文本文件编辑器，如记事本，\href{https://code.visualstudio.com/}{Visual Studio Code}，或Zotero自带的Style Editor打开csl文件。
	\item 找到bibliography 字段，添加\verb|second-field-align="flush"|，形成诸如这样的形式：
	
	\begin{lstlisting}[language=XML]	
		<bibliography entry-spacing="0" et-al-min="4" et-al-use-first="3"
		line-spacing="1" second-field-align="flush">
		<layout suffix="." locale="en">
		<text variable="citation-number" prefix="[" suffix="]"/>
		<text macro="author" suffix=". "/>
		.....
	\end{lstlisting}
	\item 而且要保证\verb|<text variable="citation-number" prefix="[" suffix="]"/>|
	字段在\verb|<layout| 和\verb|</layout>|之间。
	\item 保存文件。
	\item 在Word的Zotero工具条中点击\menu{Refresh}，或点击\menu{Document Preferences}切换为其他Style再切换回来。
	\item 看是不是对齐了，效果如\autoref{fig:ch5aligned}所示。
	%修改后的结果
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.4]{ch5aligned}
		\caption{修改后参考文献可以对齐的效果}
		\label{fig:ch5aligned}
	\end{figure}
\end{enumerate}

\section{参考文献列表只出现一个作者，然后就是“等”或“et al”了，怎么样出现全部作者的名字？}\label{sec:more-author}	

有些期刊要求参考文献列表3个作者以上时后面作者要省略，中文用“等”，英文用“et al”表示。
如何列出所有作者名字呢？可以通过修改style文件实现。
下面以Nature.csl（Nature中参考文献列表只出现一个作者，然后就是“等”或“et al”了）为例进行说明。

\begin{enumerate}
	\item 
	用任何文本文件编辑器，如记事本、\href{https://code.visualstudio.com/}{Visual Studio Code}等或Zotero自带的Style Editor，
	打开自己数据文件夹(数据文件夹在\cref{sec:data_dir}提到)下的nature.csl文件。
	\item 搜索\verb|et-al-use-first|，
	将\verb|et-al-use-first="1"|中的数字1改为一个很大的数
	（超过你文献作者最大的数字，如1000），如\autoref{fig:ch5etal-1000}所示。
	%修改后的结果
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.7]{ch5etal-1000}
		\caption{修改et al后面的数字为一个比较大的数}
		\label{fig:ch5etal-1000}
	\end{figure}
	\item 保存style文件。
	\item 在Word中的Zotero工具条中点击\menu{Refresh}，
	如果刷新无效点击\menu{Document Preferences}，切换为其他style，点击\menu{OK}，
	再点击\menu{Document Preferences}切换回Nature。
	\item 看看是不是为全部作者了。
\end{enumerate}

\section{“et al”或“等”前的逗号如何删除}\label{sec:comma-before-et-al}

大部分情况下，生成的参考文献列表中“et al”或“等”前面要求有逗号，
但某些特殊杂志如果要求“et al”或“等”前不能有逗号，可以通过修改样式文件来实现。
\begin{enumerate}
	\item 
	用任何文本文件编辑器，如记事本、\href{https://code.visualstudio.com/}{Visual Studio Code}等或Zotero自带的Style Editor，
	打开自己数据文件夹(数据文件夹在\cref{sec:data_dir}提到)下所用的Style文件。
	\item 在所有\verb|<name|字段中添加\verb|delimiter-precedes-et-al="never"|，
	如修改为：	
	
	\begin{lstlisting}[language=XML]
		<name initialize-with="." and="symbol" delimiter-precedes-et-al="never">
	\end{lstlisting}
	
	\item 保存Style文件。
	\item 在Word中的Zotero工具条中点击\menu{Refresh}，
	如果刷新无效点击\menu{Document Preferences}，切换为其他Style，点击\menu{OK}，
	再点击\menu{Document Preferences}切换回Nature。
	\item 看看是不是“et al”或“等”前面的逗号消失了。
	
	方法来源于\href{https://link.zhihu.com/?target=https%3A//forums.zotero.org/discussion/89728/et-al-without-comma%23latest}
	{Zotero Forums}。
\end{enumerate}

\section{Zotero检索引擎的使用}\label{sec:Engines}
Zotero 检索引擎调用 Zotero 文献的 metadata 信息，形成检索表达式，进而实现检索。
它可以是检索引擎，也可以仅仅是网址，起到收藏夹的作用；定制性强，可以自己编写、
添加需要的检索引擎；针对单一文献的发散性检索，明显区别于 EndNote 数据库引擎。
Zotero检索引擎的设置可以通过编辑Zotero数据文件夹(数据文件夹在\cref{sec:data_dir}提到)
中的\winpath{locate}下的engines.json
文件进行添加、删除或修改。

在Zotero中依次点击：
\menu{Edit-Settings–Advanced–Show Data Directory}，打开Zotero 
文件夹，进入\winpath{locate}目录，用文本编辑器打开engines.json。Zotero数据文件夹的打开
可见\cref{sec:Biolan}。engines.json 文件基于 OpenURL 框架编写而成，
每个检索引擎的设置放在了花括号之中，包括名称、别名、描述、
检索式等。
如下所示：
\begin{lstlisting}
	{
		"_name": "CrossRef",
		"_alias": "CrossRef",
		"_description": "CrossRef Search",
		"_icon": "https://www.crossref.org/favicon.ico",
		"_hidden": false,
		"_urlTemplate": "http://crossref.org/openurl?{z:openURL}&pid=zter:zter321",
		"_urlParams": [],
		"_urlNamespaces": {
			"z": "http://www.zotero.org/namespaces/openSearch#",
			"": "http://a9.com/-/spec/opensearch/1.1/"
		},
		"_iconSourceURI": "http://crossref.org/favicon.ico"
	}
	
\end{lstlisting}


可以从\url{https://www.jianguoyun.com/p/DfIpKNgQtOD-BRjl_MQD}下载已经编辑好的，
下载后替换掉原来的engines.json，重新启动Zotero。

在Zotero中选中文献后再点击检索引擎按钮就会出现检索的网址，
点击相应的网址就会打开浏览器进行检索，实现如检索文章文献被引查询
WOS，Google Scholar；文献网址快速打开，进而可以下载补充材料；
电子书下载；快速打开重要网址等功能。	
如\autoref{fig:ch5engines}所示：
%重启Zotero后选中文献显示的检索引擎
\begin{figure}[ht]
	\centering
	\includegraphics[scale=0.6]{ch5engines}
	\caption{重启Zotero后选中文献显示的检索引擎}
	\label{fig:ch5engines}
\end{figure}
另外，需要注意的是
自定义的 engines.json 不跟随账号进行同步，
因此换电脑需要重新配置。

Zotero 如何添加文章检索引擎见\url{https://sspai.com/post/40458}，
在Zotero中添加百度学术、
中国知网的文章检索引擎见\url{https://zhuanlan.zhihu.com/p/63941053}，
更多介绍及视频操作见Zotero检索引擎的使用\url{https://zhuanlan.zhihu.com/p/268074292}。

\section{Zotero高级搜索的使用}\label{sec:Advanced_search}
与快速检索相比，高级检索功能提供更多更细的约束条件，并且可以保存检索结果，
而且保存的搜索结果会随着Zotero库中文献的变化而发生变化，利用这个特点可以随时查看库中近1周导入的文献或是近5年的文献。

打开高级搜索的方法包括：
\begin{enumerate}
	\item 右击\menu{My Library}，选择\menu{New Saved Search}，
	如\autoref{fig:ch5Advanced_search_mylib}所示，
	弹出的对话框如\autoref{fig:ch5Advanced_search_mylib1}所示，
	可以对搜索进行命名，设置多重搜索条件。
	%右击My Library，选择New Saved Search
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.6]{ch5Advanced_search_mylib}
		\caption{右击My Library，选择New Saved Search}
		\label{fig:ch5Advanced_search_mylib}
	\end{figure}
	
	%出现的高级搜索对话框
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.6]{ch5Advanced_search_mylib1}
		\caption{高级搜索对话框1}
		\label{fig:ch5Advanced_search_mylib1}
	\end{figure}
	\item 另外，也可以在Zotero中依次点击\menu{Edit-Advanced Search}，
	如\autoref{fig:ch5EditAdSearch}所示或直接点击
	Zotero工具栏中的放大镜图标，如\autoref{fig:ch5magnifyGlass}所示打开高级搜索，
	如\autoref{fig:ch5ToolbarSearch}所示，
	界面和\autoref{fig:ch5Advanced_search_mylib1}有少许不同，
	这个上没有对搜索进行命名的Name，但是多了Save Search。
	

	%drag citataion
	\begin{figure}[htbp]
		\centering 
		\begin{minipage}[t]{0.4\linewidth}
			\centering
			\includegraphics[scale=0.6]{ch5EditAdSearch}
			\caption{点击\menu{Edit}，找到\menu{Advanced Search}}
			\label{fig:ch5EditAdSearch}
		\end{minipage}
		%
		\begin{minipage}[t]{0.4\linewidth}
			\centering
			\includegraphics[scale=0.6]{ch5magnifyGlass}
			\caption{点击放大镜打开高级检索}
			\label{fig:ch5magnifyGlass}
		\end{minipage}
	\end{figure}
	
	
	%直接点击Zotero工具栏上的放大镜图标
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.6]{ch5ToolbarSearch}
		\caption{高级搜索对话框2}
		\label{fig:ch5ToolbarSearch}
	\end{figure}
	\item 最近1周加入文献的设置方法：按照上面的方法打开高级搜索，
	Search in library中选择需要搜索的库，
	其他按\autoref{fig:ch5Last7DSearch}进行设置，然后点击
	\menu{Save Search}，输入需要保存的名称，如“最近1周文献”，点击\menu{OK}，
	则在Zotero库中就会出现\menu{最近1周文献}的分类，
	如\autoref{fig:ch5Last7DSearch1}所示，点击会显示最近1周导入的
	文献，如果库中的文献发生了变化，如新添加了文献，这个分类中的文献
	也会发生变化。
	%近1周加入文献高级搜索设置
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.5]{ch5Last7DSearch}
		\caption{近1周加入文献高级搜索设置}
		\label{fig:ch5Last7DSearch}
	\end{figure}	
	
	%近1周加入文献在Zotero中的分类
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.6]{ch5Last7DSearch1}
		\caption{近1周加入文献在Zotero中的分类}
		\label{fig:ch5Last7DSearch1}
	\end{figure}	
	
	\item 最近5年文献的设置方法：同理，打开高级搜索，
	按\autoref{fig:ch5Last5Years}进行设置，然后点击
	\menu{Save Search}，输入需要保存的名称，如“近5年文献”，点击\menu{OK}，
	则在Zotero库中就会出现“近5年文献”的分类，
	如\autoref{fig:ch5Last5Years1}所示，点击会显示最近5年的
	文献，如果库中的文献发生了变化，如新添加了文献，这个分类中的文献
	也会发生变化。
	%近5年文献高级搜索设置
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.5]{ch5Last5Years}
		\caption{近5年文献高级搜索设置}
		\label{fig:ch5Last5Years}
	\end{figure}
	%近5年文献在Zotero中的显示
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.6]{ch5Last5Years1}
		\caption{近5年文献在Zotero中的显示}
		\label{fig:ch5Last5Years1}
	\end{figure}		
\end{enumerate}

\section{如何只查找一个文件夹（分类）下的条目？}\label{sec:SearchOneCollection}
高级搜索默认是搜索整个文献库的内容，如果要搜索某个文件夹（分类）中的条目可以添加限定条件，指定要搜索的文件夹（分类）即可。方法是点击工具栏上的放大镜按钮或点击Edit-Advanced Search或直接按快捷键Ctrl+Shift+F，在弹出的对话框中，点击Match all of the following下面的向下箭头，选择Collection，第二个选is，第三个再选文件夹（分类）名称，也可以点击+，再添加其它条件。然后再点击Search即可，如\autoref{fig:ch5SearchOneCol}。
	%SearchOneCollection
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.5]{ch5SearchOneCol}
		\caption{仅在一个文件夹（分类）中搜索}
		\label{fig:ch5SearchOneCol}
	\end{figure}
\section{Zotero导入专利文献}\label{sec:Patent}
专利的检索导入可以到\href{http://cprs.patentstar.com.cn/}{专利之星检索系统}或\href{http://www.soopat.com/}{SooPAT专利检索}
进行。
Zotero官方的translator都没有针对这两个网站的，
前者可以到\href{https://github.com/l0o0/translators_CN}
{Zotero translators 中文维护小组}下载\href{https://raw.githubusercontent.com/l0o0/translators_CN/master/PatentStar.js}{PatentStar.js}和\href{https://raw.githubusercontent.com/l0o0/translators_CN/master/Soopat.js}{Soopat.js}，下载后放到Zotero数据文件夹(数据文件夹在\cref{sec:data_dir}提到)的
translators文件夹中，并更新translator\footnote{当网页加载完毕，
	且Zotero在浏览器中的图标显示为黄色的灯泡时，才算translator更新成功，才能从这两个网站正常导入专利。}，然后登录
\url{http://cprs.patentstar.com.cn/}或\url{http://www.soopat.com/}
进行检索就可以了\footnote{这两个网站可能需要注册才能检索和导入其PDF格式的全文。}。
也可以按照\cref{sec:installPlug}的方法安装\href{https://github.com/l0o0/jasminum}{茉莉花}插件后，利用\href{https://github.com/l0o0/jasminum}{茉莉花}插件更新这两个专利网站的translator。打开Zotero数据文件夹(数据文件夹在\cref{sec:data_dir}提到)和更新translator的
具体步骤可参见\cref{sec:cnki_fulltext}。

\section{Zotero中无关闭、最大化、最小化、窗口标题的窗口移动或放大缩小的方法？}\label{sec:no_max}	
由于分辨率设置不当等原因，某些窗口无关闭、最大化、最小化、窗口标题，
不能关闭，无法移动，如Zotero中Style Editor窗口，
只能在底部关闭窗口。另外百分浏览器的下载窗口也无法移动，
见\href{https://forums.zotero.org/discussion/86939/
	the-menu-and-style-name-etc-can-not-display#latest}{The menu and style name etc. can not display}
和\href{https://www.centbrowser.net/zh-cn/forum.php?mod=viewthread&tid=8321&extra=}{下载窗口无法移动吗？}

问题解决方法参考：
\href{https://www.askvg.com/how-to-move-or-resize-an-off-screen-window-in-windows/}{How to Move or Resize an Off-Screen Window in Windows?}
具体步骤如下：

点击无法移动的窗口同时按\keys{Alt+空格键}，
按\keys{M}键，再按方向箭头，即可移动窗口。
或是按\keys{S}，再按方向箭头，即可放大、缩小窗口。

或是同时按\keys{Alt+空格键}，再按方向箭头，
使光标定位到\menu{移动（M）}，按\keys{回车}，移动光标，
即可移动窗口。使光标移动到\menu{大小（S）}，
按\keys{回车}，再按方向箭头，即可放大、缩小窗口。

网友\href{https://www.zhihu.com/people/lin-zhi-70}{林知}
提供了一个更加简单的方法，按\keys{Win+\arrowkeyright}，更方便些。

\section{Zotero中如何点击父文件夹时也同时显示子文件夹内容？}\label{sec:ShowSub}	
\setcounter{footnote}{0}
	例如我有一个分类为“其它”，“其它”下面又有“安全”、“无损检测”和“蛋白质组学及氧化”三个子分类，
“其它”中有6篇文献，“安全”有25篇文献，“无损检测”63篇文献，“蛋白质组学及氧化”6篇文献，
但在点击“其它”时只显示了6篇文献，子分类“安全”、“无损检测”等文件夹中的文献没有显示，如
\autoref{fig:ch5ShowSub}所示，如何在点击其他时显示所有的6+25+63+5=99篇文献呢？
设置方法为：

在Zotero中依次点击\menu{View-Show ltems from subcollections}，如
\autoref{fig:ch5ShowItemSub}所示，
%子分类中的文献不显示
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.45]{ch5ShowSub}
		\caption{子分类中的文献不显示到父分类中}
		\label{fig:ch5ShowSub}
	\end{figure}	
	%子分类中的文献不显示设置
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.5]{ch5ShowItemSub}
		\caption{设置子分类中的文献显示到父分类中}
		\label{fig:ch5ShowItemSub}
	\end{figure}
则在下一次点击父文件夹时，其子文件夹中的文献也会显示出来\footnote{最后显示96篇的原因是，有的文献同时处理两个子文件夹中，
	所以这个“其它”文件夹中显示有96篇文献。}，
子分类中的文献显示到父分类的最终结果如
\autoref{fig:ch5ShowSubAll}所示。
如果是老版本的
Zotero，
请参见\url{https://zhuanlan.zhihu.com/p/261375851}。
关于此问题的讨论也可见\href{https://forums.zotero.org/discussion/68833/sources-in-sub-folders-not-showing-up-in-higher-level-folders}{Sources in sub-folders not showing up in higher-level folders}。
%子分类中的文献不显示设置
	\begin{figure}[ht]
		\centering
		\includegraphics[scale=0.45]{ch5ShowSubAll}
		\caption{设置子分类中的文献显示到父分类中最终效果}
		\label{fig:ch5ShowSubAll}
	\end{figure}

\section{Word中的文献如何导入到Zotero库中？}\label{sec:RefExtract}	
我们在整理汇总文件时，经常收到不同人提交的文件，里面如果也含有参考文献列表，
几份文件合并到一起时，如果是按文献引用的次序进行编码的，参考文献的顺序会发生变化，
这时就需要将各个文件的参考文献列表都导入到Zotero重新插入。
下面根据不同情况提交解决方法，
\begin{enumerate}
	\item 使用文献管理软件插入参考文献的Word（.docx）文件：
	对于使用Zotero或Mendeley插入的还有域代码的Word文件，
	可以使用\href{https://rintze.zelle.me/ref-extractor/}
	{Reference Extractor}（\url{https://rintze.zelle.me/ref-extractor/}），
	如\autoref{fig:ch5RefEtract}所示，点击选择文件，找到docx文件，
	注意一定要docx文件，doc文件无法识别。
	结果中就会显示文件中参考文献的数量和当前应用的CSL文件，
	在Optput format后面选择输出的格式，如RIS，
	预览框中就会显示提取的参考文献RIS格式。\menu{Download}，
	就可以下载文件的ris格式，再通过Zotero的\menu{File-Import}菜单导入，
	见\cref{OtherRefSoft}。
	%Reference Extractor界面
	\begin{figure}[htbp]
		\centering
		\includegraphics[scale=0.5]{ch5RefEtract}
		\caption{Reference Extractor界面}
		\label{fig:ch5RefEtract}
	\end{figure}
	\item 纯文本的参考文献列表（即已经将Word中的插入文献的链接删除，无法更新的文件）：		
	可以通过一个在线的参考文献解析网站
	\href{https://anystyle.io/}{AnyStyle}（\url{https://anystyle.io/}）
	来进行解析，例如将纯文本的参考文献信息粘贴到Parse下面的本文框中，
	点击下面的\menu{Parse * references}按钮，
	在Edit下面的框中进行编辑修改，点击识别错误的字段，
	再点击\menu{Assign label}，
	例如当前例子中就将题目、期刊都识别为作者了，
	需要手动修改字段名称。中文的识别错误较多，英文的感觉识别率还不错。
	编辑结束后，再点击\menu{3.Save}下面的\menu{BibTex}，
	如\autoref{fig:ch5RefParse}所示，下载，再从Zotero中导入，
	见\cref{OtherRefSoft}。
	%使用AnyStyle解析参考文献
	\begin{figure}[t]
		\centering
		\includegraphics[scale=0.5]{ch5RefParse}
		\caption{使用AnyStyle解析参考文献}
		\label{fig:ch5RefParse}
	\end{figure}
\end{enumerate}

其他见\href{https://zhuanlan.zhihu.com/p/309597293}
{Word中的文献如何导入到Zotero库中}
,			
参考
\url{https://www.zotero.org/support/kb/importing_formatted_bibliographies}。




其他问题见\href{https://zhuanlan.zhihu.com/p/57379260}{[Zotero]常见问题}，
或到我的知乎专栏\href{https://zhuanlan.zhihu.com/c_1071081428967743488}{软件随心}上提问。另外，
有问题也可以到Zotero的\href{https://forums.zotero.org/}{官方论坛https://forums.zotero.org/}上提出，
当前论坛十分活跃，软件开发者也会亲自回复问题，这也可以说是Zotero的另一个主要特色。如果有功能的需求，
个性化的Style需求，也可以到论坛上反馈，可以很快得到开发者的回应。


\end{document}
